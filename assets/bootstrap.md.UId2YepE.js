import{_ as r,C as o,c as l,o as h,j as i,aA as t,a,G as n,w as p}from"./chunks/framework.BeL8ovVr.js";const d="/MixedModels.jl/assets/wgrgtyb.BPC2bIEe.svg",k="/MixedModels.jl/assets/rtiioqh.DpQdthVE.svg",c="/MixedModels.jl/assets/jiwlmfz.DqWX51nA.svg",g="/MixedModels.jl/assets/ylqwxhi.DpdoTY66.svg",E="/MixedModels.jl/assets/tdvkoyv.C-b3Jy_x.svg",B=JSON.parse('{"title":"Parametric bootstrap for mixed-effects models","description":"","frontmatter":{},"headers":[],"relativePath":"bootstrap.md","filePath":"bootstrap.md","lastUpdated":null}'),u={name:"bootstrap.md"},y={class:"jldocstring custom-block",open:""},m={class:"jldocstring custom-block",open:""},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.891ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -666 1278 666","aria-hidden":"true"};function v(f,s,C,A,D,x){const e=o("Badge");return h(),l("div",null,[s[14]||(s[14]=i("h1",{id:"Parametric-bootstrap-for-mixed-effects-models",tabindex:"-1"},[a("Parametric bootstrap for mixed-effects models "),i("a",{class:"header-anchor",href:"#Parametric-bootstrap-for-mixed-effects-models","aria-label":'Permalink to "Parametric bootstrap for mixed-effects models {#Parametric-bootstrap-for-mixed-effects-models}"'},"​")],-1)),s[15]||(s[15]=i("p",null,[a("Julia is well-suited to implementing bootstrapping and other simulation-based methods for statistical models. The "),i("code",null,"parametricbootstrap"),a(" function in the "),i("a",{href:"https://github.com/JuliaStats/MixedModels.jl",target:"_blank",rel:"noreferrer"},"MixedModels package"),a(" provides an efficient parametric bootstrap for mixed-effects models.")],-1)),i("details",y,[i("summary",null,[s[0]||(s[0]=i("a",{id:"MixedModels.parametricbootstrap",href:"#MixedModels.parametricbootstrap"},[i("span",{class:"jlbinding"},"MixedModels.parametricbootstrap")],-1)),s[1]||(s[1]=a()),n(e,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[3]||(s[3]=t(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">parametricbootstrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([rng</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractRNG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], nsamp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MixedModel{T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ftype</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    β </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fixef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m), σ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">σ, θ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">θ, progress</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, optsum_overrides</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(;))</span></span></code></pre></div><p>Perform <code>nsamp</code> parametric bootstrap replication fits of <code>m</code>, returning a <code>MixedModelBootstrap</code>.</p><p>The default random number generator is <code>Random.GLOBAL_RNG</code>.</p><p><code>ftype</code> can be used to store the computed bootstrap values in a lower precision. <code>ftype</code> is not a named argument because named arguments are not used in method dispatch and thus specialization. In other words, having <code>ftype</code> as a positional argument has some potential performance benefits.</p><p><strong>Keyword Arguments</strong></p><ul><li><p><code>β</code>, <code>σ</code>, and <code>θ</code> are the values of <code>m</code>&#39;s parameters for simulating the responses.</p></li><li><p><code>σ</code> is only valid for <code>LinearMixedModel</code> and <code>GeneralizedLinearMixedModel</code> for</p></li></ul><p>families with a dispersion parameter.</p><ul><li><code>progress</code> controls whether the progress bar is shown. Note that the progress</li></ul><p>bar is automatically disabled for non-interactive (i.e. logging) contexts.</p><ul><li><code>optsum_overrides</code> is used to override values of <a href="/MixedModels.jl/api#MixedModels.OptSummary">OptSummary</a> in the models</li></ul><p>fit during the bootstrapping process. For example, <code>optsum_overrides=(;ftol_rel=1e-08)</code> reduces the convergence criterion, which can greatly speed up the bootstrap fits. Taking advantage of this speed up to increase <code>n</code> can often lead to better estimates of coverage intervals.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>All coefficients are bootstrapped. In the rank deficient case, the inestimatable coefficients are treated as -0.0 in the simulations underlying the bootstrap, which will generally result in their estimate from the simulated data also being being inestimable and thus set to -0.0. <strong>However this behavior may change in future releases to explicitly drop the extraneous columns before simulation and thus not include their estimates in the bootstrap result.</strong></p></div>`,12)),n(e,{type:"info",class:"source-link",text:"source"},{default:p(()=>s[2]||(s[2]=[i("a",{href:"https://github.com/ajinkya-k/MixedModels.jl/blob/2a9cb31d26d61efbbe2dfcff2679f35e275368ec/src/bootstrap.jl#L178-L211",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1})]),s[16]||(s[16]=t(`<h2 id="The-parametric-bootstrap" tabindex="-1">The parametric bootstrap <a class="header-anchor" href="#The-parametric-bootstrap" aria-label="Permalink to &quot;The parametric bootstrap {#The-parametric-bootstrap}&quot;">​</a></h2><p><a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)" target="_blank" rel="noreferrer">Bootstrapping</a> is a family of procedures for generating sample values of a statistic, allowing for visualization of the distribution of the statistic or for inference from this sample of values.</p><p>A <em>parametric bootstrap</em> is used with a parametric model, <code>m</code>, that has been fit to data. The procedure is to simulate <code>n</code> response vectors from <code>m</code> using the estimated parameter values and refit <code>m</code> to these responses in turn, accumulating the statistics of interest at each iteration.</p><p>The parameters of a <code>LinearMixedModel</code> object are the fixed-effects parameters, <code>β</code>, the standard deviation, <code>σ</code>, of the per-observation noise, and the covariance parameter, <code>θ</code>, that defines the variance-covariance matrices of the random effects.</p><p>For example, a simple linear mixed-effects model for the <code>Dyestuff</code> data in the <a href="http://github.com/lme4/lme4" target="_blank" rel="noreferrer"><code>lme4</code></a> package for <a href="https://www.r-project.org" target="_blank" rel="noreferrer"><code>R</code></a> is fit by</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataFrames</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Gadfly          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># plotting package</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Random</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dyestuff </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:dyestuff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(yield </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> batch)), dyestuff)</span></span></code></pre></div><div><table><tr><th align="left"></th><th align="right">Est.</th><th align="right">SE</th><th align="right">z</th><th align="right">p</th><th align="right">σ_batch</th></tr><tr><td align="left">&#40;Intercept&#41;</td><td align="right">1527.5000</td><td align="right">17.6946</td><td align="right">86.33</td><td align="right">&lt;1e-99</td><td align="right">37.2603</td></tr><tr><td align="left">Residual</td><td align="right">49.5101</td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td></tr></table>
</div><p>To bootstrap the model parameters, first initialize a random number generator then create a bootstrap sample and extract the <code>tbl</code> property, which is a <code>Table</code> - a lightweight dataframe-like object.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rng </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MersenneTwister</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1234321</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">samp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> parametricbootstrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rng, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10_000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m1);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tbl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> samp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tbl</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Table with 5 columns and 10000 rows:</span></span>
<span class="line"><span>      obj      β1       σ        σ1       θ1</span></span>
<span class="line"><span>    ┌─────────────────────────────────────────────</span></span>
<span class="line"><span> 1  │ 316.738  1528.14  43.5735  22.6691  0.520249</span></span>
<span class="line"><span> 2  │ 336.101  1552.01  58.1535  39.5166  0.679521</span></span>
<span class="line"><span> 3  │ 322.046  1501.55  51.857   0.0      0.0</span></span>
<span class="line"><span> 4  │ 326.893  1525.24  43.6512  66.3744  1.52056</span></span>
<span class="line"><span> 5  │ 331.544  1522.05  50.7415  51.0074  1.00524</span></span>
<span class="line"><span> 6  │ 326.892  1550.23  53.5174  19.0928  0.356759</span></span>
<span class="line"><span> 7  │ 313.786  1504.16  45.1878  0.0      0.0</span></span>
<span class="line"><span> 8  │ 322.636  1494.05  49.8556  17.7732  0.356494</span></span>
<span class="line"><span> 9  │ 323.582  1529.74  46.4678  35.2094  0.757716</span></span>
<span class="line"><span> 10 │ 321.639  1532.6   45.3573  32.4904  0.71632</span></span>
<span class="line"><span> 11 │ 331.565  1548.25  55.8562  28.7512  0.514736</span></span>
<span class="line"><span> 12 │ 310.076  1481.8   34.9418  38.4381  1.10006</span></span>
<span class="line"><span> 13 │ 314.492  1541.95  40.3751  28.3694  0.702646</span></span>
<span class="line"><span> 14 │ 340.876  1530.48  63.006   42.6409  0.676776</span></span>
<span class="line"><span> 15 │ 309.778  1496.17  41.5411  8.08346  0.19459</span></span>
<span class="line"><span> 16 │ 335.375  1530.32  57.4864  38.9066  0.676797</span></span>
<span class="line"><span> 17 │ 318.347  1511.28  41.0926  39.1128  0.951821</span></span>
<span class="line"><span> ⋮  │    ⋮        ⋮        ⋮        ⋮        ⋮</span></span></code></pre></div><p>A density plot of the estimates of <code>σ</code>, the residual standard deviation, can be created as</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tbl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">σ, Geom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density, Guide</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">xlabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Parametric bootstrap estimates of σ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p><img src="`+d+'" alt=""></p><p>or, for the intercept parameter</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tbl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">β1, Geom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density, Guide</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">xlabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Parametric bootstrap estimates of β₁&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p><img src="'+k+`" alt=""></p><p>A density plot of the estimates of the standard deviation of the random effects is obtained as</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tbl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">σ1, Geom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Guide</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">xlabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Parametric bootstrap estimates of σ₁&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p><img src="`+c+`" alt=""></p><p>Notice that this density plot has a spike, or mode, at zero. Although this mode appears to be diffuse, this is an artifact of the way that density plots are created. In fact, it is a pulse, as can be seen from a histogram.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tbl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">σ1, Geom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">histogram,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Guide</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">xlabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Parametric bootstrap estimates of σ₁&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p><img src="`+g+'" alt=""></p><p>The bootstrap sample can be used to generate intervals that cover a certain percentage of the bootstrapped values. We refer to these as &quot;coverage intervals&quot;, similar to a confidence interval. The shortest such intervals, obtained with the <code>shortestcovint</code> extractor, correspond to a highest posterior density interval in Bayesian inference.</p>',24)),i("details",m,[i("summary",null,[s[4]||(s[4]=i("a",{id:"MixedModels.shortestcovint",href:"#MixedModels.shortestcovint"},[i("span",{class:"jlbinding"},"MixedModels.shortestcovint")],-1)),s[5]||(s[5]=a()),n(e,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[8]||(s[8]=t('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">shortestcovint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v, level </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.95</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the shortest interval containing <code>level</code> proportion of the values of <code>v</code></p>',2)),n(e,{type:"info",class:"source-link",text:"source"},{default:p(()=>s[6]||(s[6]=[i("a",{href:"https://github.com/ajinkya-k/MixedModels.jl/blob/2a9cb31d26d61efbbe2dfcff2679f35e275368ec/src/bootstrap.jl#L475-L479",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1}),s[9]||(s[9]=t('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">shortestcovint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bsamp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MixedModelFitCollection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, level </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.95</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the shortest interval containing <code>level</code> proportion for each parameter from <code>bsamp.allpars</code>.</p><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>Currently, correlations that are systematically zero are included in the the result. This may change in a future release without being considered a breaking change.</p></div>',3)),n(e,{type:"info",class:"source-link",text:"source"},{default:p(()=>s[7]||(s[7]=[i("a",{href:"https://github.com/ajinkya-k/MixedModels.jl/blob/2a9cb31d26d61efbbe2dfcff2679f35e275368ec/src/bootstrap.jl#L495-L504",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1})]),s[17]||(s[17]=t(`<p>We generate these directly from the original bootstrap object:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">shortestcovint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(samp))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Table with 5 columns and 3 rows:</span></span>
<span class="line"><span>     type  group     names        lower    upper</span></span>
<span class="line"><span>   ┌──────────────────────────────────────────────</span></span>
<span class="line"><span> 1 │ β     missing   (Intercept)  1491.05  1560.55</span></span>
<span class="line"><span> 2 │ σ     batch     (Intercept)  0.0      54.5795</span></span>
<span class="line"><span> 3 │ σ     residual  missing      35.5329  62.4926</span></span></code></pre></div><p>A value of zero for the standard deviation of the random effects is an example of a <em>singular</em> covariance. It is easy to detect the singularity in the case of a scalar random-effects term. However, it is not as straightforward to detect singularity in vector-valued random-effects terms.</p><p>For example, if we bootstrap a model fit to the <code>sleepstudy</code> data</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sleepstudy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:sleepstudy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contrasts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:subj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Grouping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, f, sleepstudy; contrasts)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div><table><tr><th align="left"></th><th align="right">Est.</th><th align="right">SE</th><th align="right">z</th><th align="right">p</th><th align="right">σ_subj</th></tr><tr><td align="left">&#40;Intercept&#41;</td><td align="right">251.4051</td><td align="right">6.6323</td><td align="right">37.91</td><td align="right">&lt;1e-99</td><td align="right">23.7805</td></tr><tr><td align="left">days</td><td align="right">10.4673</td><td align="right">1.5022</td><td align="right">6.97</td><td align="right">&lt;1e-11</td><td align="right">5.7168</td></tr><tr><td align="left">Residual</td><td align="right">25.5918</td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td></tr></table>
</div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">samp2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> parametricbootstrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rng, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10_000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m2);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tbl2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> samp2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tbl</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Table with 10 columns and 10000 rows:</span></span>
<span class="line"><span>      obj      β1       β2       σ        σ1       σ2       ρ1            ⋯</span></span>
<span class="line"><span>    ┌──────────────────────────────────────────────────────────────────────</span></span>
<span class="line"><span> 1  │ 1722.37  250.895  11.2108  23.7292  30.5601  3.37877  0.411488      ⋯</span></span>
<span class="line"><span> 2  │ 1739.83  247.783  10.3058  24.5781  25.4753  5.35103  0.169341      ⋯</span></span>
<span class="line"><span> 3  │ 1766.11  262.917  8.67368  26.8278  29.1042  4.58544  0.299448      ⋯</span></span>
<span class="line"><span> 4  │ 1753.44  239.594  12.3773  26.4169  23.5469  4.85682  -0.276483     ⋯</span></span>
<span class="line"><span> 5  │ 1763.1   255.882  12.2247  26.0867  25.0354  6.47175  0.197525      ⋯</span></span>
<span class="line"><span> 6  │ 1750.25  253.685  11.4426  25.765   25.4656  4.95775  -0.135672     ⋯</span></span>
<span class="line"><span> 7  │ 1741.06  260.753  11.7569  24.7662  22.4896  6.18852  -0.195575     ⋯</span></span>
<span class="line"><span> 8  │ 1763.54  265.992  9.65105  26.7659  27.1736  4.60808  0.41623       ⋯</span></span>
<span class="line"><span> 9  │ 1728.66  254.054  7.96851  22.5055  32.7443  7.31196  -0.22585      ⋯</span></span>
<span class="line"><span> 10 │ 1743.41  249.924  13.8011  25.4967  24.6412  4.42374  -0.0827561    ⋯</span></span>
<span class="line"><span> 11 │ 1770.33  245.364  10.4891  26.971   21.6813  6.70116  0.0669261     ⋯</span></span>
<span class="line"><span> 12 │ 1712.07  248.638  8.90521  23.8102  18.5346  4.1671   1.0           ⋯</span></span>
<span class="line"><span> 13 │ 1756.39  254.155  11.6857  26.659   22.4518  4.58876  0.716327      ⋯</span></span>
<span class="line"><span> 14 │ 1766.77  244.488  11.8403  26.3666  25.5431  6.57234  -0.000934562  ⋯</span></span>
<span class="line"><span> 15 │ 1736.64  248.273  9.54573  23.4296  25.658   7.65951  0.169105      ⋯</span></span>
<span class="line"><span> 16 │ 1729.64  249.183  6.88315  23.2126  29.8659  5.85546  0.0474053     ⋯</span></span>
<span class="line"><span> 17 │ 1762.76  255.458  8.14682  27.8165  18.0569  4.26976  0.0949213     ⋯</span></span>
<span class="line"><span> ⋮  │    ⋮        ⋮        ⋮        ⋮        ⋮        ⋮          ⋮        ⋱</span></span></code></pre></div>`,9)),i("p",null,[s[12]||(s[12]=a("the singularity can be exhibited as a standard deviation of zero or as a correlation of ")),i("mjx-container",b,[(h(),l("svg",F,s[10]||(s[10]=[t('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="B1" d="M56 320T56 333T70 353H369V502Q369 651 371 655Q376 666 388 666Q402 666 405 654T409 596V500V353H707Q722 345 722 333Q722 320 707 313H409V40H707Q722 32 722 20T707 0H70Q56 7 56 20T70 40H369V313H70Q56 320 56 333Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path></g></g></g>',1)]))),s[11]||(s[11]=i("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("mo",null,"±"),i("mn",null,"1")])],-1))]),s[13]||(s[13]=a("."))]),s[18]||(s[18]=t(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">shortestcovint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(samp2)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>6-element Vector{NamedTuple{(:type, :group, :names, :lower, :upper)}}:</span></span>
<span class="line"><span> (type = &quot;β&quot;, group = missing, names = &quot;(Intercept)&quot;, lower = 238.62114296228958, upper = 264.77008622888087)</span></span>
<span class="line"><span> (type = &quot;β&quot;, group = missing, names = &quot;days&quot;, lower = 7.678713379429666, upper = 13.499638908887992)</span></span>
<span class="line"><span> (type = &quot;σ&quot;, group = &quot;subj&quot;, names = &quot;(Intercept)&quot;, lower = 10.771353181876954, upper = 33.48808668437545)</span></span>
<span class="line"><span> (type = &quot;σ&quot;, group = &quot;subj&quot;, names = &quot;days&quot;, lower = 2.9147425023494873, upper = 7.6167848472947215)</span></span>
<span class="line"><span> (type = &quot;ρ&quot;, group = &quot;subj&quot;, names = &quot;(Intercept), days&quot;, lower = -0.4114607353123966, upper = 1.0)</span></span>
<span class="line"><span> (type = &quot;σ&quot;, group = &quot;residual&quot;, names = missing, lower = 22.61648805602028, upper = 28.452289496499983)</span></span></code></pre></div><p>A histogram of the estimated correlations from the bootstrap sample has a spike at <code>+1</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tbl2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ρ1, Geom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">histogram,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Guide</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">xlabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Parametric bootstrap samples of correlation of random effects&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p><img src="`+E+`" alt=""></p><p>or, as a count,</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tbl2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ρ1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.≈</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>336</span></span></code></pre></div><p>Close examination of the histogram shows a few values of <code>-1</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tbl2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ρ1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.≈</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>0</span></span></code></pre></div><p>Furthermore there are even a few cases where the estimate of the standard deviation of the random effect for the intercept is zero.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tbl2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">σ1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.≈</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>3</span></span></code></pre></div><p>There is a general condition to check for singularity of an estimated covariance matrix or matrices in a bootstrap sample. The parameter optimized in the estimation is <code>θ</code>, the relative covariance parameter. Some of the elements of this parameter vector must be non-negative and, when one of these components is approximately zero, one of the covariance matrices will be singular.</p><p>The <code>issingular</code> method for a <code>MixedModel</code> object that tests if a parameter vector <code>θ</code> corresponds to a boundary or singular fit.</p><p>This operation is encapsulated in a method for the <code>issingular</code> function.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">issingular</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(samp2))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>339</span></span></code></pre></div><h2 id="Reduced-Precision-Bootstrap" tabindex="-1">Reduced Precision Bootstrap <a class="header-anchor" href="#Reduced-Precision-Bootstrap" aria-label="Permalink to &quot;Reduced Precision Bootstrap {#Reduced-Precision-Bootstrap}&quot;">​</a></h2><p><code>parametricbootstrap</code> accepts an optional keyword argument <code>optsum_overrides</code>, which can be used to override the convergence criteria for bootstrap replicates. One possibility is setting <code>ftol_rel=1e-8</code>, i.e., considering the model converged when the relative change in the objective between optimizer iterations is smaller than 0.00000001. This threshold corresponds approximately to the precision from treating the value of the objective as a single precision (<code>Float32</code>) number, while not changing the precision of the intermediate computations. The resultant loss in precision will generally be smaller than the variation that the bootstrap captures, but can greatly speed up the fitting process for each replicates, especially for large models. More directly, lowering the fit quality for each replicate will reduce the quality of each replicate, but this may be more than compensated for by the ability to fit a much larger number of replicates in the same time.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @timed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> parametricbootstrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MersenneTwister</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m2; progress</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>0.3808735</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">optsum_overrides </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (; ftol_rel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @timed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> parametricbootstrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MersenneTwister</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m2; optsum_overrides, progress</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>0.33436075</span></span></code></pre></div><h2 id="Distributed-Computing-and-the-Bootstrap" tabindex="-1">Distributed Computing and the Bootstrap <a class="header-anchor" href="#Distributed-Computing-and-the-Bootstrap" aria-label="Permalink to &quot;Distributed Computing and the Bootstrap {#Distributed-Computing-and-the-Bootstrap}&quot;">​</a></h2><p>Earlier versions of MixedModels.jl supported a multi-threaded bootstrap via the <code>use_threads</code> keyword argument. However, with improved BLAS multithreading, the Julia-level threads often wound up competing with the BLAS threads, leading to no improvement or even a worsening of performance when <code>use_threads=true</code>. Nonetheless, the bootstrap is a classic example of an <a href="https://en.wikipedia.org/wiki/Embarrassingly_parallel" target="_blank" rel="noreferrer">embarrassingly parallel</a> problem and so we provide a few convenience methods for combining results computed separately. In particular, there are <code>vcat</code> and an optimized <code>reduce(::typeof(vcat))</code> methods for <code>MixedModelBootstrap</code> objects. For computers with many processors (as opposed to a single processor with several cores) or for computing clusters, these provide a convenient way to split the computation across nodes.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Distributed</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># you already have 1 proc by default, so add the number of additional cores with \`addprocs\`</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># you need at least as many RNGs as cores you want to use in parallel</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># but you shouldn&#39;t use all of your cores because nested within this</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># is the multithreading of the linear algebra</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># addprocs(1)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Currently using </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(nprocs())</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> processors total and </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(nworkers())</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for work&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Load the necessary packages on all workers</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># For clusters, you will also need to make sure that the Julia</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># environment (Project.toml) is set up and activated on each worker.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@everywhere</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> begin</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ProgressMeter</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># copy everything to workers</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@showprogress</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> workers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    remotecall_fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> coefnames</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m2), w)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># split the replicates across the workers</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># this rounds down, so if the number of workers doesn&#39;t divide the</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># number of replicates, you&#39;ll be a few replicates short!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_replicates </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_rep_per_worker </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n_replicates </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">÷</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nworkers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># NB: You need a different seed/RNG for each worker otherwise you will</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># have copies of the same replicates and not independent replicates!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pb_map </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @showprogress</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pmap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MersenneTwister</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nworkers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rng</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    parametricbootstrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rng, n_rep_per_worker, m2; optsum_overrides)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># get rid of all the workers</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># rmprocs(workers())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">confint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reduce</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vcat, pb_map))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DictTable with 2 columns and 6 rows:</span></span>
<span class="line"><span> par   lower      upper</span></span>
<span class="line"><span> ────┬───────────────────</span></span>
<span class="line"><span> β1  │ 238.218    263.636</span></span>
<span class="line"><span> β2  │ 7.41896    13.1753</span></span>
<span class="line"><span> ρ1  │ -0.392873  1.0</span></span>
<span class="line"><span> σ   │ 22.5319    28.5051</span></span>
<span class="line"><span> σ1  │ 10.3848    33.8593</span></span>
<span class="line"><span> σ2  │ 2.91779    7.65655</span></span></code></pre></div>`,29))])}const _=r(u,[["render",v]]);export{B as __pageData,_ as default};

<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Model constructors | MixedModels</title>
    <meta name="description" content="Documentation for MixedModels.jl">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/MixedModels.jl/assets/style.DV9bnI3v.css" as="style">
    <link rel="preload stylesheet" href="/MixedModels.jl/vp-icons.css" as="style">
    
    <script type="module" src="/MixedModels.jl/assets/app.DRZcVcO0.js"></script>
    <link rel="preload" href="/MixedModels.jl/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/MixedModels.jl/assets/chunks/theme.DFEB430V.js">
    <link rel="modulepreload" href="/MixedModels.jl/assets/chunks/framework.BeL8ovVr.js">
    <link rel="modulepreload" href="/MixedModels.jl/assets/constructors.md.jcwYrVSW.lean.js">
    <script src="/MixedModels.jl/versions.js"></script>
    <script src="/MixedModels.jl/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/MixedModels.jl/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/MixedModels.jl/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>MixedModels</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/MixedModels.jl/index" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>MixedModels.jl Documentation</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Articles</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link active" href="/MixedModels.jl/constructors" data-v-acbfed09><!--[--><span data-v-acbfed09>Model constructors</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/MixedModels.jl/optimization" data-v-acbfed09><!--[--><span data-v-acbfed09>Details of the parameter estimation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/MixedModels.jl/GaussHermite" data-v-acbfed09><!--[--><span data-v-acbfed09>Normalized Gauss-Hermite Quadrature</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/MixedModels.jl/prediction" data-v-acbfed09><!--[--><span data-v-acbfed09>Prediction and simulation in Mixed-Effects Models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/MixedModels.jl/bootstrap" data-v-acbfed09><!--[--><span data-v-acbfed09>Parametric bootstrap for mixed-effects models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/MixedModels.jl/rankdeficiency" data-v-acbfed09><!--[--><span data-v-acbfed09>Rank deficiency in mixed-effects models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/MixedModels.jl/mime" data-v-acbfed09><!--[--><span data-v-acbfed09>Alternative display and output formats</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/MixedModels.jl/api" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>API</span><!--]--></a><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/ajinkya-k/MixedModels.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/ajinkya-k/MixedModels.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/MixedModels.jl/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>MixedModels.jl Documentation</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Articles</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/MixedModels.jl/constructors" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Model constructors</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/MixedModels.jl/optimization" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Details of the parameter estimation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/MixedModels.jl/GaussHermite" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Normalized Gauss-Hermite Quadrature</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/MixedModels.jl/prediction" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Prediction and simulation in Mixed-Effects Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/MixedModels.jl/bootstrap" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Parametric bootstrap for mixed-effects models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/MixedModels.jl/rankdeficiency" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Rank deficiency in mixed-effects models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/MixedModels.jl/mime" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Alternative display and output formats</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/MixedModels.jl/api" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>API</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _MixedModels_jl_constructors" data-v-83890dd9><div><h1 id="Model-constructors" tabindex="-1">Model constructors <a class="header-anchor" href="#Model-constructors" aria-label="Permalink to &quot;Model constructors {#Model-constructors}&quot;">​</a></h1><p>The <code>LinearMixedModel</code> type represents a linear mixed-effects model. Typically it is constructed from a <code>Formula</code> and an appropriate <code>Table</code> type, usually a <code>DataFrame</code>.</p><h2 id="Examples-of-linear-mixed-effects-model-fits" tabindex="-1">Examples of linear mixed-effects model fits <a class="header-anchor" href="#Examples-of-linear-mixed-effects-model-fits" aria-label="Permalink to &quot;Examples of linear mixed-effects model fits {#Examples-of-linear-mixed-effects-model-fits}&quot;">​</a></h2><p>For illustration, several data sets from the <em>lme4</em> package for <em>R</em> are made available in <code>.arrow</code> format in this package. Often, for convenience, we will convert these to <code>DataFrame</code>s. These data sets include the <code>dyestuff</code> and <code>dyestuff2</code> data sets.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataFrames, MixedModels, StatsModels</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dyestuff </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:dyestuff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Arrow.Table with 30 rows, 2 columns, and schema:</span></span>
<span class="line"><span> :batch  String</span></span>
<span class="line"><span> :yield  Int16</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dyestuff))</span></span></code></pre></div><div><div><div style = "float: left;"><span>2×7 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">variable</th><th style = "text-align: left;">mean</th><th style = "text-align: left;">min</th><th style = "text-align: left;">median</th><th style = "text-align: left;">max</th><th style = "text-align: left;">nmissing</th><th style = "text-align: left;">eltype</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Symbol" style = "text-align: left;">Symbol</th><th title = "Union{Nothing, Float64}" style = "text-align: left;">Union…</th><th title = "Any" style = "text-align: left;">Any</th><th title = "Union{Nothing, Float64}" style = "text-align: left;">Union…</th><th title = "Any" style = "text-align: left;">Any</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "DataType" style = "text-align: left;">DataType</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">batch</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">A</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">F</td><td style = "text-align: right;">0</td><td style = "text-align: left;">String</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">yield</td><td style = "text-align: left;">1527.5</td><td style = "text-align: left;">1440</td><td style = "text-align: left;">1530.0</td><td style = "text-align: left;">1635</td><td style = "text-align: right;">0</td><td style = "text-align: left;">Int16</td></tr></tbody></table></div></div><h3 id="The-@formula-language-in-Julia" tabindex="-1">The <code>@formula</code> language in Julia <a class="header-anchor" href="#The-@formula-language-in-Julia" aria-label="Permalink to &quot;The `@formula` language in Julia {#The-@formula-language-in-Julia}&quot;">​</a></h3><p>MixedModels.jl builds on the the <em>Julia</em> formula language provided by <a href="https://juliastats.org/StatsModels.jl/stable/formula/" target="_blank" rel="noreferrer">StatsModels.jl</a>, which is similar to the formula language in <em>R</em> and is also based on the notation from Wilkinson and Rogers (<a href="https://dx.doi.org/10.2307/2346786" target="_blank" rel="noreferrer">1973</a>). There are two ways to construct a formula in Julia. The first way is to enclose the formula expression in the <code>@formula</code> macro:</p><details class="jldocstring custom-block" open><summary><a id="StatsModels.@formula" href="#StatsModels.@formula"><span class="jlbinding">StatsModels.@formula</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ex)</span></span></code></pre></div><p>Capture and parse a formula expression as a <code>Formula</code> struct.</p><p>A formula is an abstract specification of a dependence between <em>left-hand</em> and <em>right-hand</em> side variables as in, e.g., a regression model. Each side specifies at a high level how tabular data is to be converted to a numerical matrix suitable for modeling. This specification looks something like Julia code, is represented as a Julia <code>Expr</code>, but uses special syntax. The <code>@formula</code> macro takes an expression like <code>y ~ 1 + a*b</code>, transforms it according to the formula syntax rules into a lowered form (like <code>y ~ 1 + a + b + a&amp;b</code>), and constructs a <code>Formula</code> struct which captures the original expression, the lowered expression, and the left- and right-hand-side.</p><p>Operators that have special interpretations in this syntax are</p><ul><li><p><code>~</code> is the formula separator, where it is a binary operator (the first argument is the left-hand side, and the second is the right-hand side.</p></li><li><p><code>+</code> concatenates variables as columns when generating a model matrix.</p></li><li><p><code>&amp;</code> represents an <em>interaction</em> between two or more variables, which corresponds to a row-wise kronecker product of the individual terms (or element-wise product if all terms involved are continuous/scalar).</p></li><li><p><code>*</code> expands to all main effects and interactions: <code>a*b</code> is equivalent to <code>a+b+a&amp;b</code>, <code>a*b*c</code> to <code>a+b+c+a&amp;b+a&amp;c+b&amp;c+a&amp;b&amp;c</code>, etc.</p></li><li><p><code>1</code>, <code>0</code>, and <code>-1</code> indicate the presence (for <code>1</code>) or absence (for <code>0</code> and <code>-1</code>) of an intercept column.</p></li></ul><p>The rules that are applied are</p><ul><li><p>The associative rule (un-nests nested calls to <code>+</code>, <code>&amp;</code>, and <code>*</code>).</p></li><li><p>The distributive rule (interactions <code>&amp;</code> distribute over concatenation <code>+</code>).</p></li><li><p>The <code>*</code> rule expands <code>a*b</code> to <code>a+b+a&amp;b</code> (recursively).</p></li><li><p>Subtraction is converted to addition and negation, so <code>x-1</code> becomes <code>x + -1</code> (applies only to subtraction of literal 1).</p></li><li><p>Single-argument <code>&amp;</code> calls are stripped, so <code>&amp;(x)</code> becomes the main effect <code>x</code>.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsModels.jl/blob/v0.7.4/src/formula.jl#L23-L59" target="_blank" rel="noreferrer">source</a><!--]--></span></details><p>The second way is to combine <code>Term</code>s with operators like <code>+</code>, <code>&amp;</code>, <code>~</code>, and others at &quot;run time&quot;. This is especially useful if you wish to create a formula from a list a variable names. For instance, the following are equivalent:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">term</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> term</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> term</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> term</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> term</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> term</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>true</span></span></code></pre></div><p>MixedModels.jl provides additional formula syntax for representing <em>random-effects terms</em>. Most importantly, <code>|</code> separates random effects and their grouping factors (as in the formula extension used by the <em>R</em> package <a href="https://cran.r-project.org/web/packages/lme4/index.html" target="_blank" rel="noreferrer"><code>lme4</code></a>. Much like with the base formula language, <code>|</code> can be used within the <code>@formula</code> macro and to construct a formula programmatically:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> g))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>FormulaTerm</span></span>
<span class="line"><span>Response:</span></span>
<span class="line"><span>  y(unknown)</span></span>
<span class="line"><span>Predictors:</span></span>
<span class="line"><span>  1</span></span>
<span class="line"><span>  a(unknown)</span></span>
<span class="line"><span>  b(unknown)</span></span>
<span class="line"><span>  (a,b,g)-&gt;(1 + a + b) | g</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">terms </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">term</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(t) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">group </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> term</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:g</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> term</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> terms </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (terms </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> group)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>FormulaTerm</span></span>
<span class="line"><span>Response:</span></span>
<span class="line"><span>  y(unknown)</span></span>
<span class="line"><span>Predictors:</span></span>
<span class="line"><span>  1</span></span>
<span class="line"><span>  a(unknown)</span></span>
<span class="line"><span>  b(unknown)</span></span>
<span class="line"><span>  (1 + a + b | g)</span></span></code></pre></div><h3 id="Models-with-simple,-scalar-random-effects" tabindex="-1">Models with simple, scalar random effects <a class="header-anchor" href="#Models-with-simple,-scalar-random-effects" aria-label="Permalink to &quot;Models with simple, scalar random effects {#Models-with-simple,-scalar-random-effects}&quot;">​</a></h3><p>A basic model with simple, scalar random effects for the levels of <code>batch</code> (the batch of an intermediate product, in this case) is declared and fit as</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(yield </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">batch))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, fm, dyestuff)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> yield ~ 1 + (1 | batch)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -163.6635   327.3271   333.3271   334.2501   337.5307</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.</span></span>
<span class="line"><span>batch    (Intercept)  1388.3332 37.2603</span></span>
<span class="line"><span>Residual              2451.2501 49.5101</span></span>
<span class="line"><span> Number of obs: 30; levels of grouping factors: 6</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>────────────────────────────────────────────────</span></span>
<span class="line"><span>              Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  1527.5     17.6946  86.33    &lt;1e-99</span></span>
<span class="line"><span>────────────────────────────────────────────────</span></span></code></pre></div><p>(If you are new to Julia you may find that this first fit takes an unexpectedly long time, due to Just-In-Time (JIT) compilation of the code. The subsequent calls to such functions are much faster.)</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BenchmarkTools</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dyestuff2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:dyestuff2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@benchmark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dyestuff2)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BenchmarkTools.Trial: 10000 samples with 1 evaluation per sample.</span></span>
<span class="line"><span> Range (min … max):  51.708 μs …  38.877 ms  ┊ GC (min … max): 0.00% … 94.86%</span></span>
<span class="line"><span> Time  (median):     57.375 μs               ┊ GC (median):    0.00%</span></span>
<span class="line"><span> Time  (mean ± σ):   61.609 μs ± 388.200 μs  ┊ GC (mean ± σ):  5.99% ±  0.95%</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                       ▂▇██▇▆▅▅▅▃▁                              </span></span>
<span class="line"><span>  ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▃▄▇███████████▇▆▆▅▄▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁ ▃</span></span>
<span class="line"><span>  51.7 μs         Histogram: frequency by time         64.3 μs &lt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span> Memory estimate: 49.91 KiB, allocs estimate: 1073.</span></span></code></pre></div><p>By default, the model is fit by maximum likelihood. To use the <code>REML</code> criterion instead, add the optional named argument <code>REML=true</code> to the call to <code>fit</code></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm1reml </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, fm, dyestuff, REML</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by REML</span></span>
<span class="line"><span> yield ~ 1 + (1 | batch)</span></span>
<span class="line"><span> REML criterion at convergence: 319.65427684225943</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.</span></span>
<span class="line"><span>batch    (Intercept)  1764.0537 42.0006</span></span>
<span class="line"><span>Residual              2451.2492 49.5101</span></span>
<span class="line"><span> Number of obs: 30; levels of grouping factors: 6</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>────────────────────────────────────────────────</span></span>
<span class="line"><span>              Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  1527.5     19.3834  78.80    &lt;1e-99</span></span>
<span class="line"><span>────────────────────────────────────────────────</span></span></code></pre></div><h3 id="Floating-point-type-in-the-model" tabindex="-1">Floating-point type in the model <a class="header-anchor" href="#Floating-point-type-in-the-model" aria-label="Permalink to &quot;Floating-point type in the model {#Floating-point-type-in-the-model}&quot;">​</a></h3><p>The type of <code>fm1</code></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>LinearMixedModel{Float64}</span></span></code></pre></div><p>includes the floating point type used internally for the various matrices, vectors, and scalars that represent the model. At present, this will always be <code>Float64</code> because the parameter estimates are optimized using the <a href="https://github.com/JuliaOpt/NLopt.jl" target="_blank" rel="noreferrer"><code>NLopt</code> package</a> which calls compiled C code that only allows for optimization with respect to a <code>Float64</code> parameter vector.</p><p>So in theory other floating point types, such as <code>BigFloat</code> or <code>Float32</code>, can be used to define a model but in practice only <code>Float64</code> works at present.</p><blockquote><p>In theory, theory and practice are the same. In practice, they aren&#39;t. – Anon</p></blockquote><h3 id="Simple,-scalar-random-effects" tabindex="-1">Simple, scalar random effects <a class="header-anchor" href="#Simple,-scalar-random-effects" aria-label="Permalink to &quot;Simple, scalar random effects {#Simple,-scalar-random-effects}&quot;">​</a></h3><p>A simple, scalar random effects term in a mixed-effects model formula is of the form <code>(1|G)</code>. All random effects terms end with <code>|G</code> where <code>G</code> is the <em>grouping factor</em> for the random effect. The name or, more generally the expression, <code>G</code>, should evaluate to a categorical array that has a distinct set of <em>levels</em>. The random effects are associated with the levels of the grouping factor.</p><p>A <em>scalar</em> random effect is, as the name implies, one scalar value for each level of the grouping factor. A <em>simple, scalar</em> random effects term is of the form, <code>(1|G)</code>. It corresponds to a shift in the intercept for each level of the grouping factor.</p><h3 id="Models-with-vector-valued-random-effects" tabindex="-1">Models with vector-valued random effects <a class="header-anchor" href="#Models-with-vector-valued-random-effects" aria-label="Permalink to &quot;Models with vector-valued random effects {#Models-with-vector-valued-random-effects}&quot;">​</a></h3><p>The <em>sleepstudy</em> data are observations of reaction time, <code>reaction</code>, on several subjects, <code>subj</code>, after 0 to 9 days of sleep deprivation, <code>days</code>. A model with random intercepts and random slopes for each subject, allowing for within-subject correlation of the slope and intercept, is fit as</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sleepstudy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:sleepstudy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), sleepstudy)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + (1 + days | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -875.9697  1751.9393  1763.9393  1764.4249  1783.0971</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.   Corr.</span></span>
<span class="line"><span>subj     (Intercept)  565.51066 23.78047</span></span>
<span class="line"><span>         days          32.68212  5.71683 +0.08</span></span>
<span class="line"><span>Residual              654.94145 25.59182</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span>
<span class="line"><span>                Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  251.405      6.63226  37.91    &lt;1e-99</span></span>
<span class="line"><span>days          10.4673     1.50224   6.97    &lt;1e-11</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span></code></pre></div><h3 id="Models-with-multiple,-scalar-random-effects-terms" tabindex="-1">Models with multiple, scalar random-effects terms <a class="header-anchor" href="#Models-with-multiple,-scalar-random-effects-terms" aria-label="Permalink to &quot;Models with multiple, scalar random-effects terms {#Models-with-multiple,-scalar-random-effects-terms}&quot;">​</a></h3><p>A model for the <em>Penicillin</em> data incorporates random effects for the plate, and for the sample. As every sample is used on every plate these two factors are <em>crossed</em>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">penicillin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:penicillin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(diameter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plate) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sample)), penicillin)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> diameter ~ 1 + (1 | plate) + (1 | sample)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -166.0942   332.1883   340.1883   340.4761   352.0676</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column   Variance Std.Dev. </span></span>
<span class="line"><span>plate    (Intercept)  0.714979 0.845565</span></span>
<span class="line"><span>sample   (Intercept)  3.135193 1.770648</span></span>
<span class="line"><span>Residual              0.302426 0.549933</span></span>
<span class="line"><span> Number of obs: 144; levels of grouping factors: 24, 6</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span>
<span class="line"><span>               Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  22.9722    0.744596  30.85    &lt;1e-99</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span></code></pre></div><p>In contrast, the <code>cask</code> grouping factor is <em>nested</em> within the <code>batch</code> grouping factor in the <em>Pastes</em> data.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pastes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DataFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:pastes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pastes)</span></span></code></pre></div><div><div><div style = "float: left;"><span>3×7 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">variable</th><th style = "text-align: left;">mean</th><th style = "text-align: left;">min</th><th style = "text-align: left;">median</th><th style = "text-align: left;">max</th><th style = "text-align: left;">nmissing</th><th style = "text-align: left;">eltype</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Symbol" style = "text-align: left;">Symbol</th><th title = "Union{Nothing, Float64}" style = "text-align: left;">Union…</th><th title = "Any" style = "text-align: left;">Any</th><th title = "Union{Nothing, Float64}" style = "text-align: left;">Union…</th><th title = "Any" style = "text-align: left;">Any</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "DataType" style = "text-align: left;">DataType</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">batch</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">A</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">J</td><td style = "text-align: right;">0</td><td style = "text-align: left;">String</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">cask</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">a</td><td style = "font-style: italic; text-align: left;"></td><td style = "text-align: left;">c</td><td style = "text-align: right;">0</td><td style = "text-align: left;">String</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">strength</td><td style = "text-align: left;">60.0533</td><td style = "text-align: left;">54.2</td><td style = "text-align: left;">59.3</td><td style = "text-align: left;">66.0</td><td style = "text-align: right;">0</td><td style = "text-align: left;">Float64</td></tr></tbody></table></div></div><p>This can be expressed using the solidus (the &quot;<code>/</code>&quot; character) to separate grouping factors, read &quot;<code>cask</code> nested within <code>batch</code>&quot;:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm4a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(strength </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">batch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cask)), pastes)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> strength ~ 1 + (1 | batch) + (1 | batch &amp; cask)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -123.9972   247.9945   255.9945   256.7217   264.3718</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>                Column   Variance Std.Dev. </span></span>
<span class="line"><span>batch &amp; cask (Intercept)  8.433617 2.904069</span></span>
<span class="line"><span>batch        (Intercept)  1.199180 1.095071</span></span>
<span class="line"><span>Residual                  0.678002 0.823409</span></span>
<span class="line"><span> Number of obs: 60; levels of grouping factors: 30, 10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span>
<span class="line"><span>               Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  60.0533    0.642136  93.52    &lt;1e-99</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span></code></pre></div><p>If the levels of the inner grouping factor are unique across the levels of the outer grouping factor, then this nesting does not need to expressed explicitly in the model syntax. For example, defining <code>sample</code> to be the combination of <code>batch</code> and <code>cask</code>, yields a naming scheme where the nesting is apparent from the data even if not expressed in the formula. (That is, each level of <code>sample</code> occurs in conjunction with only one level of <code>batch</code>.) As such, this model is equivalent to the previous one.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pastes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sample </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(pastes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cask, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&amp;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  pastes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">batch))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm4b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(strength </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sample) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">batch)), pastes)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> strength ~ 1 + (1 | sample) + (1 | batch)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -123.9972   247.9945   255.9945   256.7217   264.3718</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column   Variance Std.Dev. </span></span>
<span class="line"><span>sample   (Intercept)  8.433617 2.904069</span></span>
<span class="line"><span>batch    (Intercept)  1.199178 1.095070</span></span>
<span class="line"><span>Residual              0.678002 0.823409</span></span>
<span class="line"><span> Number of obs: 60; levels of grouping factors: 30, 10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span>
<span class="line"><span>               Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  60.0533    0.642136  93.52    &lt;1e-99</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span></code></pre></div><p>In observational studies it is common to encounter <em>partially crossed</em> grouping factors. For example, the <em>InstEval</em> data are course evaluations by students, <code>s</code>, of instructors, <code>d</code>. Additional covariates include the academic department, <code>dept</code>, in which the course was given and <code>service</code>, whether or not it was a service course.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">insteval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:insteval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> service </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dept </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d)), insteval)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> y ~ 1 + service + dept + service &amp; dept + (1 | s) + (1 | d)</span></span>
<span class="line"><span>    logLik     -2 logLik       AIC         AICc          BIC     </span></span>
<span class="line"><span> -118792.7767  237585.5534  237647.5534  237647.5804  237932.8763</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column   Variance Std.Dev. </span></span>
<span class="line"><span>s        (Intercept)  0.105418 0.324681</span></span>
<span class="line"><span>d        (Intercept)  0.258416 0.508347</span></span>
<span class="line"><span>Residual              1.384728 1.176745</span></span>
<span class="line"><span> Number of obs: 73421; levels of grouping factors: 2972, 1128</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>────────────────────────────────────────────────────────────────</span></span>
<span class="line"><span>                              Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>────────────────────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)              3.27628      0.0793647  41.28    &lt;1e-99</span></span>
<span class="line"><span>service: Y               0.0116044    0.0699321   0.17    0.8682</span></span>
<span class="line"><span>dept: D02               -0.0411091    0.120331   -0.34    0.7326</span></span>
<span class="line"><span>dept: D03                0.00967413   0.108411    0.09    0.9289</span></span>
<span class="line"><span>dept: D04                0.105017     0.0944964   1.11    0.2664</span></span>
<span class="line"><span>dept: D05                0.0828643    0.11148     0.74    0.4573</span></span>
<span class="line"><span>dept: D06               -0.01194      0.0978342  -0.12    0.9029</span></span>
<span class="line"><span>dept: D07                0.0992679    0.110598    0.90    0.3694</span></span>
<span class="line"><span>dept: D08                0.0575337    0.127935    0.45    0.6529</span></span>
<span class="line"><span>dept: D09               -0.00263181   0.107085   -0.02    0.9804</span></span>
<span class="line"><span>dept: D10               -0.223423     0.099838   -2.24    0.0252</span></span>
<span class="line"><span>dept: D11                0.0129816    0.110639    0.12    0.9066</span></span>
<span class="line"><span>dept: D12                0.00503825   0.0944243   0.05    0.9574</span></span>
<span class="line"><span>dept: D14                0.0050827    0.109041    0.05    0.9628</span></span>
<span class="line"><span>dept: D15               -0.0466719    0.101942   -0.46    0.6471</span></span>
<span class="line"><span>service: Y &amp; dept: D02  -0.144352     0.0929527  -1.55    0.1204</span></span>
<span class="line"><span>service: Y &amp; dept: D03   0.0174078    0.0927237   0.19    0.8511</span></span>
<span class="line"><span>service: Y &amp; dept: D04  -0.0381262    0.0810901  -0.47    0.6382</span></span>
<span class="line"><span>service: Y &amp; dept: D05   0.0596632    0.123952    0.48    0.6303</span></span>
<span class="line"><span>service: Y &amp; dept: D06  -0.254044     0.080781   -3.14    0.0017</span></span>
<span class="line"><span>service: Y &amp; dept: D07  -0.151634     0.11157    -1.36    0.1741</span></span>
<span class="line"><span>service: Y &amp; dept: D08   0.0508942    0.112189    0.45    0.6501</span></span>
<span class="line"><span>service: Y &amp; dept: D09  -0.259448     0.0899448  -2.88    0.0039</span></span>
<span class="line"><span>service: Y &amp; dept: D10   0.25907      0.111369    2.33    0.0200</span></span>
<span class="line"><span>service: Y &amp; dept: D11  -0.276577     0.0819621  -3.37    0.0007</span></span>
<span class="line"><span>service: Y &amp; dept: D12  -0.0418489    0.0792928  -0.53    0.5977</span></span>
<span class="line"><span>service: Y &amp; dept: D14  -0.256742     0.0931016  -2.76    0.0058</span></span>
<span class="line"><span>service: Y &amp; dept: D15   0.24042      0.0982071   2.45    0.0144</span></span>
<span class="line"><span>────────────────────────────────────────────────────────────────</span></span></code></pre></div><h3 id="Simplifying-the-random-effect-correlation-structure" tabindex="-1">Simplifying the random effect correlation structure <a class="header-anchor" href="#Simplifying-the-random-effect-correlation-structure" aria-label="Permalink to &quot;Simplifying the random effect correlation structure {#Simplifying-the-random-effect-correlation-structure}&quot;">​</a></h3><p>MixedModels.jl estimates not only the <em>variance</em> of the effects for each random effect level, but also the <em>correlation</em> between the random effects for different predictors. So, for the model of the <em>sleepstudy</em> data above, one of the parameters that is estimated is the correlation between each subject&#39;s random intercept (i.e., their baseline reaction time) and slope (i.e., their particular change in reaction time per day of sleep deprivation). In some cases, you may wish to simplify the random effects structure by removing these correlation parameters. This often arises when there are many random effects you want to estimate (as is common in psychological experiments with many conditions and covariates), since the number of random effects parameters increases as the square of the number of predictors, making these models difficult to estimate from limited data.</p><p>The special syntax <code>zerocorr</code> can be applied to individual random effects terms inside the <code>@formula</code>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm2zerocorr_fm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zerocorr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), sleepstudy)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + zerocorr(1 + days | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -876.0016  1752.0033  1762.0033  1762.3481  1777.9680</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.   Corr.</span></span>
<span class="line"><span>subj     (Intercept)  584.25897 24.17145</span></span>
<span class="line"><span>         days          33.63281  5.79938   .  </span></span>
<span class="line"><span>Residual              653.11578 25.55613</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span>
<span class="line"><span>                Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  251.405      6.70771  37.48    &lt;1e-99</span></span>
<span class="line"><span>days          10.4673     1.51931   6.89    &lt;1e-11</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span></code></pre></div><p>Alternatively, correlations between parameters can be removed by including them as separate random effects terms:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), sleepstudy)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + (1 | subj) + (days | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -876.0016  1752.0033  1762.0033  1762.3481  1777.9680</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.   Corr.</span></span>
<span class="line"><span>subj     (Intercept)  584.25897 24.17145</span></span>
<span class="line"><span>         days          33.63281  5.79938   .  </span></span>
<span class="line"><span>Residual              653.11578 25.55613</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span>
<span class="line"><span>                Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  251.405      6.70771  37.48    &lt;1e-99</span></span>
<span class="line"><span>days          10.4673     1.51931   6.89    &lt;1e-11</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span></code></pre></div><p>Finally, for predictors that are categorical, MixedModels.jl will estimate correlations between each level. Notice the large number of correlation parameters if we treat <code>days</code> as a categorical variable by giving it contrasts:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), sleepstudy,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contrasts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DummyCoding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + (1 + days | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -805.3994  1610.7987  1742.7987  1821.0642  1953.5339</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance  Std.Dev.   Corr.</span></span>
<span class="line"><span>subj     (Intercept)   954.66067 30.89758</span></span>
<span class="line"><span>         days: 1       498.34749 22.32370 -0.30</span></span>
<span class="line"><span>         days: 2       916.26827 30.26992 -0.57 +0.75</span></span>
<span class="line"><span>         days: 3      1268.96763 35.62257 -0.37 +0.72 +0.87</span></span>
<span class="line"><span>         days: 4      1487.09850 38.56292 -0.31 +0.59 +0.67 +0.91</span></span>
<span class="line"><span>         days: 5      2302.20224 47.98127 -0.25 +0.46 +0.45 +0.70 +0.85</span></span>
<span class="line"><span>         days: 6      3851.78092 62.06272 -0.27 +0.30 +0.48 +0.70 +0.77 +0.75</span></span>
<span class="line"><span>         days: 7      1808.39158 42.52519 -0.16 +0.22 +0.47 +0.50 +0.63 +0.64 +0.71</span></span>
<span class="line"><span>         days: 8      3159.98677 56.21376 -0.20 +0.29 +0.36 +0.56 +0.73 +0.90 +0.73 +0.74</span></span>
<span class="line"><span>         days: 9      3086.04128 55.55215 +0.06 +0.26 +0.16 +0.38 +0.59 +0.78 +0.38 +0.53 +0.85</span></span>
<span class="line"><span>Residual                18.79114  4.33488</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>                 Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  256.652       7.35396  34.90    &lt;1e-99</span></span>
<span class="line"><span>days: 1        7.84395     5.45654   1.44    0.1506</span></span>
<span class="line"><span>days: 2        8.71009     7.27954   1.20    0.2315</span></span>
<span class="line"><span>days: 3       26.3402      8.51975   3.09    0.0020</span></span>
<span class="line"><span>days: 4       31.9976      9.2035    3.48    0.0005</span></span>
<span class="line"><span>days: 5       51.8666     11.4012    4.55    &lt;1e-05</span></span>
<span class="line"><span>days: 6       55.5265     14.6995    3.78    0.0002</span></span>
<span class="line"><span>days: 7       62.0988     10.1269    6.13    &lt;1e-09</span></span>
<span class="line"><span>days: 8       79.9777     13.3283    6.00    &lt;1e-08</span></span>
<span class="line"><span>days: 9       94.1994     13.1733    7.15    &lt;1e-12</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span></code></pre></div><p>Separating the <code>1</code> and <code>days</code> random effects into separate terms removes the correlations between the intercept and the levels of <code>days</code>, but not between the levels themselves:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), sleepstudy,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contrasts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DummyCoding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + (1 | subj) + (days | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -827.7749  1655.5498  1769.5498  1823.7465  1951.5483</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.  Corr.</span></span>
<span class="line"><span>subj     (Intercept)   789.6792 28.1012</span></span>
<span class="line"><span>         days: 1         0.0000  0.0000   .  </span></span>
<span class="line"><span>         days: 2       357.7766 18.9150   .    +NaN</span></span>
<span class="line"><span>         days: 3       684.7231 26.1672   .    +NaN +0.81</span></span>
<span class="line"><span>         days: 4       949.6394 30.8162   .    +NaN +0.57 +0.91</span></span>
<span class="line"><span>         days: 5      1751.2433 41.8479   .    +NaN +0.26 +0.66 +0.87</span></span>
<span class="line"><span>         days: 6      3357.4474 57.9435   .    +NaN +0.45 +0.72 +0.80 +0.76</span></span>
<span class="line"><span>         days: 7      1539.1760 39.2323   .    +NaN +0.39 +0.42 +0.59 +0.62 +0.71</span></span>
<span class="line"><span>         days: 8      2735.1879 52.2990   .    +NaN +0.22 +0.52 +0.75 +0.93 +0.72 +0.75</span></span>
<span class="line"><span>         days: 9      2767.1610 52.6038   .    +NaN -0.05 +0.28 +0.57 +0.80 +0.34 +0.52 +0.87</span></span>
<span class="line"><span>Residual               135.0061 11.6192</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>                 Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  256.652       7.16738  35.81    &lt;1e-99</span></span>
<span class="line"><span>days: 1        7.84395     3.87307   2.03    0.0428</span></span>
<span class="line"><span>days: 2        8.71009     5.90569   1.47    0.1402</span></span>
<span class="line"><span>days: 3       26.3402      7.28291   3.62    0.0003</span></span>
<span class="line"><span>days: 4       31.9976      8.23155   3.89    0.0001</span></span>
<span class="line"><span>days: 5       51.8667     10.5968    4.89    &lt;1e-06</span></span>
<span class="line"><span>days: 6       55.5265     14.196     3.91    &lt;1e-04</span></span>
<span class="line"><span>days: 7       62.0988     10.0255    6.19    &lt;1e-09</span></span>
<span class="line"><span>days: 8       79.9777     12.9211    6.19    &lt;1e-09</span></span>
<span class="line"><span>days: 9       94.1994     12.9897    7.25    &lt;1e-12</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span></code></pre></div><p>(Notice that the variance component for <code>days: 1</code> is estimated as zero, so the correlations for this component are undefined and expressed as <code>NaN</code>, not a number.)</p><p>An alternative is to force all the levels of <code>days</code> as indicators using <code>fulldummy</code> encoding.</p><details class="jldocstring custom-block" open><summary><a id="MixedModels.fulldummy" href="#MixedModels.fulldummy"><span class="jlbinding">MixedModels.fulldummy</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fulldummy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(term</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CategoricalTerm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Assign &quot;contrasts&quot; that include all indicator columns (dummy variables) and an intercept column.</p><p>This will result in an under-determined set of contrasts, which is not a problem in the random effects because of the regularization, or &quot;shrinkage&quot;, of the conditional modes.</p><p>The interaction of <code>fulldummy</code> with complex random effects is subtle and complex with numerous potential edge cases. As we discover these edge cases, we will document and determine their behavior. Until such time, please check the model summary to verify that the expansion is working as you expected. If it is not, please report a use case on GitHub.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/randomeffectsterm.jl#L195-L207" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fulldummy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(days)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), sleepstudy,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contrasts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DummyCoding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + (1 + days | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -805.3991  1610.7982  1764.7982  1882.5630  2010.6559</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance  Std.Dev.   Corr.</span></span>
<span class="line"><span>subj     (Intercept)   727.90862 26.97978</span></span>
<span class="line"><span>         days: 0       499.02116 22.33878 -0.22</span></span>
<span class="line"><span>         days: 1       381.88986 19.54200 -0.07 +0.44</span></span>
<span class="line"><span>         days: 2       463.96481 21.53984 -0.34 +0.05 +0.53</span></span>
<span class="line"><span>         days: 3       379.47587 19.48014 +0.28 -0.45 +0.18 +0.63</span></span>
<span class="line"><span>         days: 4       327.96770 18.10988 +0.65 -0.82 -0.38 -0.07 +0.66</span></span>
<span class="line"><span>         days: 5      1051.33792 32.42434 +0.42 -0.52 -0.30 -0.27 +0.20 +0.62</span></span>
<span class="line"><span>         days: 6      2321.59696 48.18295 +0.27 -0.48 -0.44 -0.08 +0.36 +0.58 +0.54</span></span>
<span class="line"><span>         days: 7      1134.97511 33.68939 +0.27 -0.12 -0.28 +0.06 -0.03 +0.18 +0.32 +0.48</span></span>
<span class="line"><span>         days: 8      1870.82916 43.25308 +0.35 -0.41 -0.41 -0.27 +0.04 +0.45 +0.82 +0.55 +0.55</span></span>
<span class="line"><span>         days: 9      2277.31514 47.72122 +0.47 -0.14 -0.15 -0.34 -0.10 +0.32 +0.67 +0.07 +0.32 +0.78</span></span>
<span class="line"><span>Residual                19.21115  4.38305</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>                 Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  256.652       7.36068  34.87    &lt;1e-99</span></span>
<span class="line"><span>days: 1        7.84395     5.4558    1.44    0.1505</span></span>
<span class="line"><span>days: 2        8.71009     7.28336   1.20    0.2317</span></span>
<span class="line"><span>days: 3       26.3402      8.52163   3.09    0.0020</span></span>
<span class="line"><span>days: 4       31.9976      9.20409   3.48    0.0005</span></span>
<span class="line"><span>days: 5       51.8667     11.3962    4.55    &lt;1e-05</span></span>
<span class="line"><span>days: 6       55.5265     14.7077    3.78    0.0002</span></span>
<span class="line"><span>days: 7       62.0988     10.1303    6.13    &lt;1e-09</span></span>
<span class="line"><span>days: 8       79.9777     13.3249    6.00    &lt;1e-08</span></span>
<span class="line"><span>days: 9       94.1994     13.1611    7.16    &lt;1e-12</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span></code></pre></div><p>This fit produces a better fit as measured by the objective (negative twice the log-likelihood is 1610.8) but at the expense of adding many more parameters to the model. As a result, model comparison criteria such, as <code>AIC</code> and <code>BIC</code>, are inflated.</p><p>But using <code>zerocorr</code> on the individual terms does remove the correlations between the levels:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zerocorr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), sleepstudy,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contrasts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DummyCoding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + zerocorr(1 + days | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -882.9138  1765.8276  1807.8276  1813.6757  1874.8797</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.  Corr.</span></span>
<span class="line"><span>subj     (Intercept)   958.4877 30.9595</span></span>
<span class="line"><span>         days: 1         0.0000  0.0000   .  </span></span>
<span class="line"><span>         days: 2         0.0000  0.0000   .     .  </span></span>
<span class="line"><span>         days: 3         0.0000  0.0000   .     .     .  </span></span>
<span class="line"><span>         days: 4         0.0000  0.0000   .     .     .     .  </span></span>
<span class="line"><span>         days: 5       519.6167 22.7951   .     .     .     .     .  </span></span>
<span class="line"><span>         days: 6      1704.1051 41.2808   .     .     .     .     .     .  </span></span>
<span class="line"><span>         days: 7       608.7869 24.6736   .     .     .     .     .     .     .  </span></span>
<span class="line"><span>         days: 8      1273.0228 35.6794   .     .     .     .     .     .     .     .  </span></span>
<span class="line"><span>         days: 9      1753.8569 41.8791   .     .     .     .     .     .     .     .     .  </span></span>
<span class="line"><span>Residual               434.8673 20.8535</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>                 Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  256.652       8.79822  29.17    &lt;1e-99</span></span>
<span class="line"><span>days: 1        7.84395     6.95116   1.13    0.2591</span></span>
<span class="line"><span>days: 2        8.71009     6.95116   1.25    0.2102</span></span>
<span class="line"><span>days: 3       26.3402      6.95116   3.79    0.0002</span></span>
<span class="line"><span>days: 4       31.9976      6.95116   4.60    &lt;1e-05</span></span>
<span class="line"><span>days: 5       51.8667      8.78557   5.90    &lt;1e-08</span></span>
<span class="line"><span>days: 6       55.5265     11.9579    4.64    &lt;1e-05</span></span>
<span class="line"><span>days: 7       62.0988      9.06312   6.85    &lt;1e-11</span></span>
<span class="line"><span>days: 8       79.9777     10.9106    7.33    &lt;1e-12</span></span>
<span class="line"><span>days: 9       94.1994     12.0729    7.80    &lt;1e-14</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zerocorr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), sleepstudy,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contrasts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DummyCoding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + (1 | subj) + zerocorr(days | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -882.9138  1765.8276  1807.8276  1813.6757  1874.8797</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.  Corr.</span></span>
<span class="line"><span>subj     (Intercept)   958.4877 30.9595</span></span>
<span class="line"><span>         days: 1         0.0000  0.0000   .  </span></span>
<span class="line"><span>         days: 2         0.0000  0.0000   .     .  </span></span>
<span class="line"><span>         days: 3         0.0000  0.0000   .     .     .  </span></span>
<span class="line"><span>         days: 4         0.0000  0.0000   .     .     .     .  </span></span>
<span class="line"><span>         days: 5       519.6167 22.7951   .     .     .     .     .  </span></span>
<span class="line"><span>         days: 6      1704.1051 41.2808   .     .     .     .     .     .  </span></span>
<span class="line"><span>         days: 7       608.7869 24.6736   .     .     .     .     .     .     .  </span></span>
<span class="line"><span>         days: 8      1273.0228 35.6794   .     .     .     .     .     .     .     .  </span></span>
<span class="line"><span>         days: 9      1753.8569 41.8791   .     .     .     .     .     .     .     .     .  </span></span>
<span class="line"><span>Residual               434.8673 20.8535</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>                 Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  256.652       8.79822  29.17    &lt;1e-99</span></span>
<span class="line"><span>days: 1        7.84395     6.95116   1.13    0.2591</span></span>
<span class="line"><span>days: 2        8.71009     6.95116   1.25    0.2102</span></span>
<span class="line"><span>days: 3       26.3402      6.95116   3.79    0.0002</span></span>
<span class="line"><span>days: 4       31.9976      6.95116   4.60    &lt;1e-05</span></span>
<span class="line"><span>days: 5       51.8667      8.78557   5.90    &lt;1e-08</span></span>
<span class="line"><span>days: 6       55.5265     11.9579    4.64    &lt;1e-05</span></span>
<span class="line"><span>days: 7       62.0988      9.06312   6.85    &lt;1e-11</span></span>
<span class="line"><span>days: 8       79.9777     10.9106    7.33    &lt;1e-12</span></span>
<span class="line"><span>days: 9       94.1994     12.0729    7.80    &lt;1e-14</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zerocorr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fulldummy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(days)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), sleepstudy,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contrasts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:days</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DummyCoding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + zerocorr(1 + days | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -878.9843  1757.9686  1801.9686  1808.4145  1872.2137</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance  Std.Dev.   Corr.</span></span>
<span class="line"><span>subj     (Intercept)  1135.22369 33.69308</span></span>
<span class="line"><span>         days: 0       775.53471 27.84842   .  </span></span>
<span class="line"><span>         days: 1       357.33070 18.90319   .     .  </span></span>
<span class="line"><span>         days: 2       221.08627 14.86897   .     .     .  </span></span>
<span class="line"><span>         days: 3         0.00000  0.00000   .     .     .     .  </span></span>
<span class="line"><span>         days: 4        44.25126  6.65216   .     .     .     .     .  </span></span>
<span class="line"><span>         days: 5       670.03272 25.88499   .     .     .     .     .     .  </span></span>
<span class="line"><span>         days: 6      1739.38985 41.70599   .     .     .     .     .     .     .  </span></span>
<span class="line"><span>         days: 7       908.48034 30.14101   .     .     .     .     .     .     .     .  </span></span>
<span class="line"><span>         days: 8      1457.44632 38.17652   .     .     .     .     .     .     .     .     .  </span></span>
<span class="line"><span>         days: 9      2027.51717 45.02796   .     .     .     .     .     .     .     .     .     .  </span></span>
<span class="line"><span>Residual               181.13013 13.45846</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>                 Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  256.652      10.7804   23.81    &lt;1e-99</span></span>
<span class="line"><span>days: 1        7.84395     9.11387   0.86    0.3894</span></span>
<span class="line"><span>days: 2        8.71009     8.68869   1.00    0.3161</span></span>
<span class="line"><span>days: 3       26.3402      7.95052   3.31    0.0009</span></span>
<span class="line"><span>days: 4       31.9976      8.10366   3.95    &lt;1e-04</span></span>
<span class="line"><span>days: 5       51.8666     10.0217    5.18    &lt;1e-06</span></span>
<span class="line"><span>days: 6       55.5264     12.6429    4.39    &lt;1e-04</span></span>
<span class="line"><span>days: 7       62.0988     10.6622    5.82    &lt;1e-08</span></span>
<span class="line"><span>days: 8       79.9777     12.0075    6.66    &lt;1e-10</span></span>
<span class="line"><span>days: 9       94.1994     13.2609    7.10    &lt;1e-11</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span></code></pre></div><h2 id="Fitting-generalized-linear-mixed-models" tabindex="-1">Fitting generalized linear mixed models <a class="header-anchor" href="#Fitting-generalized-linear-mixed-models" aria-label="Permalink to &quot;Fitting generalized linear mixed models {#Fitting-generalized-linear-mixed-models}&quot;">​</a></h2><p>To create a GLMM representation, the distribution family for the response, and possibly the link function, must be specified.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">verbagg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:verbagg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">verbaggform </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(r2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> anger </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gender </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> btype </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> situ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gm1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, verbaggform, verbagg, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bernoulli</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Generalized Linear Mixed Model fit by maximum likelihood (nAGQ = 1)</span></span>
<span class="line"><span>  r2 ~ 1 + anger + gender + btype + situ + mode + (1 | subj) + (1 | item)</span></span>
<span class="line"><span>  Distribution: Bernoulli{Float64}</span></span>
<span class="line"><span>  Link: LogitLink()</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   logLik    deviance     AIC       AICc        BIC    </span></span>
<span class="line"><span> -4067.9164  8135.8329  8153.8329  8153.8566  8216.2370</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>        Column   Variance Std.Dev. </span></span>
<span class="line"><span>subj (Intercept)  1.793488 1.339212</span></span>
<span class="line"><span>item (Intercept)  0.117149 0.342271</span></span>
<span class="line"><span></span></span>
<span class="line"><span> Number of obs: 7584; levels of grouping factors: 316, 24</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Fixed-effects parameters:</span></span>
<span class="line"><span>──────────────────────────────────────────────────────</span></span>
<span class="line"><span>                   Coef.  Std. Error       z  Pr(&gt;|z|)</span></span>
<span class="line"><span>──────────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)   -0.152977    0.385222    -0.40    0.6913</span></span>
<span class="line"><span>anger          0.0573961   0.0167528    3.43    0.0006</span></span>
<span class="line"><span>gender: M      0.320783    0.191207     1.68    0.0934</span></span>
<span class="line"><span>btype: scold  -1.05988     0.184159    -5.76    &lt;1e-08</span></span>
<span class="line"><span>btype: shout  -2.10389     0.186517   -11.28    &lt;1e-28</span></span>
<span class="line"><span>situ: self    -1.05438     0.151194    -6.97    &lt;1e-11</span></span>
<span class="line"><span>mode: want     0.706981    0.151007     4.68    &lt;1e-05</span></span>
<span class="line"><span>──────────────────────────────────────────────────────</span></span></code></pre></div><p>The canonical link, which is <code>LogitLink</code> for the <code>Bernoulli</code> distribution, is used if no explicit link is specified.</p><p>Note that, in keeping with convention in the <a href="https://github.com/JuliaStats/GLM.jl" target="_blank" rel="noreferrer"><code>GLM</code> package</a>, the distribution family for a binary (i.e. 0/1) response is the <code>Bernoulli</code> distribution. The <code>Binomial</code> distribution is only used when the response is the fraction of trials returning a positive, in which case the number of trials must be specified as the case weights.</p><h3 id="Optional-arguments-to-fit" tabindex="-1">Optional arguments to fit <a class="header-anchor" href="#Optional-arguments-to-fit" aria-label="Permalink to &quot;Optional arguments to fit {#Optional-arguments-to-fit}&quot;">​</a></h3><p>An alternative approach is to create the <code>GeneralizedLinearMixedModel</code> object then call <code>fit!</code> on it. The optional arguments <code>fast</code> and/or <code>nAGQ</code> can be passed to the optimization process via both <code>fit</code> and <code>fit!</code> (i.e these optimization settings are not used nor recognized when constructing the model).</p><p>As the name implies, <code>fast=true</code>, provides a faster but somewhat less accurate fit. These fits may suffice for model comparisons.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gm1a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, verbaggform, verbagg, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bernoulli</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), fast </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">deviance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm1a) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> deviance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>0.33801335722546355</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@benchmark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">verbaggform, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">verbagg, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bernoulli</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BenchmarkTools.Trial: 4 samples with 1 evaluation per sample.</span></span>
<span class="line"><span> Range (min … max):  1.433 s …   1.488 s  ┊ GC (min … max): 0.00% … 0.00%</span></span>
<span class="line"><span> Time  (median):     1.460 s              ┊ GC (median):    0.00%</span></span>
<span class="line"><span> Time  (mean ± σ):   1.460 s ± 30.730 ms  ┊ GC (mean ± σ):  0.00% ± 0.00%</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ██                                                     ██  </span></span>
<span class="line"><span>  ██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██ ▁</span></span>
<span class="line"><span>  1.43 s         Histogram: frequency by time        1.49 s &lt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span> Memory estimate: 29.89 MiB, allocs estimate: 472457.</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@benchmark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">verbaggform, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">verbagg, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bernoulli</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), fast </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BenchmarkTools.Trial: 53 samples with 1 evaluation per sample.</span></span>
<span class="line"><span> Range (min … max):  93.280 ms … 105.816 ms  ┊ GC (min … max): 0.00% … 0.00%</span></span>
<span class="line"><span> Time  (median):     94.050 ms               ┊ GC (median):    0.00%</span></span>
<span class="line"><span> Time  (mean ± σ):   95.436 ms ±   2.947 ms  ┊ GC (mean ± σ):  0.20% ± 1.00%</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ██ ▂                                                          </span></span>
<span class="line"><span>  ██▅█▁▅▅▃▁▆▃▁▃▃▃▁▁▅▁▅▁▁▁▁▁▃▁▃▃▃▁▁▃▁▁▁▁▁▁▃▁▁▁▁▁▁▁▁▃▁▁▁▁▁▁▁▁▁▁▃ ▁</span></span>
<span class="line"><span>  93.3 ms         Histogram: frequency by time          105 ms &lt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span> Memory estimate: 9.54 MiB, allocs estimate: 82996.</span></span></code></pre></div><p>The optional argument <code>nAGQ=k</code> causes evaluation of the deviance function to use a <code>k</code> point adaptive Gauss-Hermite quadrature rule. This method only applies to models with a single, simple, scalar random-effects term, such as</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contraception </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:contra</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contraform </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(use </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> abs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(age) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> livch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> urban </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dist));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bernoulli </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Bernoulli</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deviances </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict{Symbol,Float64}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @benchmarkable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> deviances[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> deviance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contraform, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contraception, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bernoulli));</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(b)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @benchmarkable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> deviances[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:fast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> deviance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contraform, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contraception, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bernoulli, fast </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(b)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @benchmarkable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> deviances[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:nAGQ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> deviance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contraform, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contraception, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bernoulli, nAGQ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(b)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @benchmarkable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> deviances[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:nAGQ_fast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> deviance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contraform, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contraception, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bernoulli, nAGQ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fast</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(b)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(deviances)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>OrderedCollections.OrderedDict{Symbol, Float64} with 4 entries:</span></span>
<span class="line"><span>  :default   =&gt; 2372.73</span></span>
<span class="line"><span>  :fast      =&gt; 2372.78</span></span>
<span class="line"><span>  :nAGQ      =&gt; 2372.46</span></span>
<span class="line"><span>  :nAGQ_fast =&gt; 2372.51</span></span></code></pre></div><h1 id="Extractor-functions" tabindex="-1">Extractor functions <a class="header-anchor" href="#Extractor-functions" aria-label="Permalink to &quot;Extractor functions {#Extractor-functions}&quot;">​</a></h1><p><code>LinearMixedModel</code> and <code>GeneralizedLinearMixedModel</code> are subtypes of <code>StatsAPI.RegressionModel</code> which, in turn, is a subtype of <code>StatsBase.StatisticalModel</code>. Many of the generic extractors defined in the <code>StatsBase</code> package have methods for these models.</p><h2 id="Model-fit-statistics" tabindex="-1">Model-fit statistics <a class="header-anchor" href="#Model-fit-statistics" aria-label="Permalink to &quot;Model-fit statistics {#Model-fit-statistics}&quot;">​</a></h2><p>The statistics describing the quality of the model fit include</p><details class="jldocstring custom-block" open><summary><a id="StatsAPI.loglikelihood" href="#StatsAPI.loglikelihood"><span class="jlbinding">StatsAPI.loglikelihood</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loglikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loglikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, observation)</span></span></code></pre></div><p>Return the log-likelihood of the model.</p><p>With an <code>observation</code> argument, return the contribution of <code>observation</code> to the log-likelihood of <code>model</code>.</p><p>If <code>observation</code> is a <code>Colon</code>, return a vector of each observation&#39;s contribution to the log-likelihood of the model. In other words, this is the vector of the pointwise log-likelihood contributions.</p><p>In general, <code>sum(loglikehood(model, :)) == loglikelihood(model)</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/statisticalmodel.jl#L68-L82" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="StatsAPI.aic" href="#StatsAPI.aic"><span class="jlbinding">StatsAPI.aic</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">aic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Akaike&#39;s Information Criterion, defined as <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.466ex;" xmlns="http://www.w3.org/2000/svg" width="13.153ex" height="2.036ex" role="img" focusable="false" viewBox="0 -694 5813.8 900" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1444.7,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z" style="stroke-width:3;"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(278,0)" style="stroke-width:3;"></path><path data-c="67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z" transform="translate(778,0)" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(2722.7,0)"><path data-c="2061" d="" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2889.3,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3792.6,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(4792.8,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(5292.8,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mn>2</mn><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>L</mi><mo>+</mo><mn>2</mn><mi>k</mi></math></mjx-assistive-mml></mjx-container>, with <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:0;" xmlns="http://www.w3.org/2000/svg" width="1.541ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 681 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></mjx-assistive-mml></mjx-container> the likelihood of the model, and <code>k</code> its number of consumed degrees of freedom (as returned by <a href="/MixedModels.jl/constructors#StatsAPI.dof"><code>dof</code></a>).</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/statisticalmodel.jl#L182-L188" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="StatsAPI.bic" href="#StatsAPI.bic"><span class="jlbinding">StatsAPI.bic</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Bayesian Information Criterion, defined as <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.466ex;" xmlns="http://www.w3.org/2000/svg" width="17.025ex" height="2.036ex" role="img" focusable="false" viewBox="0 -694 7525.1 900" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1444.7,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z" style="stroke-width:3;"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(278,0)" style="stroke-width:3;"></path><path data-c="67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z" transform="translate(778,0)" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(2722.7,0)"><path data-c="2061" d="" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2889.3,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3792.6,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(4792.8,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(5480.4,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z" style="stroke-width:3;"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(278,0)" style="stroke-width:3;"></path><path data-c="67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z" transform="translate(778,0)" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(6758.4,0)"><path data-c="2061" d="" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(6925.1,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mn>2</mn><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>L</mi><mo>+</mo><mi>k</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>n</mi></math></mjx-assistive-mml></mjx-container>, with <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:0;" xmlns="http://www.w3.org/2000/svg" width="1.541ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 681 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></mjx-assistive-mml></mjx-container> the likelihood of the model, <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.179ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 521 705" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container> its number of consumed degrees of freedom (as returned by <a href="/MixedModels.jl/constructors#StatsAPI.dof"><code>dof</code></a>), and <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container> the number of observations (as returned by <a href="/MixedModels.jl/constructors#StatsAPI.nobs"><code>nobs</code></a>).</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/statisticalmodel.jl#L205-L212" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="StatsAPI.dof" href="#StatsAPI.dof"><span class="jlbinding">StatsAPI.dof</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the number of degrees of freedom consumed in the model, including when applicable the intercept and the distribution&#39;s dispersion parameter.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/statisticalmodel.jl#L114-L119" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="StatsAPI.nobs" href="#StatsAPI.nobs"><span class="jlbinding">StatsAPI.nobs</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nobs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the number of independent observations on which the model was fitted. Be careful when using this information, as the definition of an independent observation may vary depending on the model, on the format used to pass the data, on the sampling plan (if specified), etc.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/statisticalmodel.jl#L104-L111" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loglikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-163.6635299405715</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">aic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>333.327059881143</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>337.5306520261295</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1 fixed effect, 2 variances</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>3</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nobs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 30 observations</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>30</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loglikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-4067.9164291743905</span></span></code></pre></div><p>In general the <a href="https://en.wikipedia.org/wiki/Deviance_(statistics)" target="_blank" rel="noreferrer"><code>deviance</code></a> of a statistical model fit is negative twice the log-likelihood adjusting for the saturated model.</p><details class="jldocstring custom-block" open><summary><a id="StatsAPI.deviance-Tuple{StatisticalModel}" href="#StatsAPI.deviance-Tuple{StatisticalModel}"><span class="jlbinding">StatsAPI.deviance</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">deviance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GeneralizedLinearMixedModel{T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, nAGQ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {T}</span></span></code></pre></div><p>Return the deviance of <code>m</code> evaluated by the Laplace approximation (<code>nAGQ=1</code>) or <code>nAGQ</code>-point adaptive Gauss-Hermite quadrature.</p><p>If the distribution <code>D</code> does not have a scale parameter the Laplace approximation is the squared length of the conditional modes, <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.294ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 572 453" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml></mjx-container>, plus the determinant of <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.186ex;" xmlns="http://www.w3.org/2000/svg" width="14.062ex" height="1.903ex" role="img" focusable="false" viewBox="0 -759 6215.4 841" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D6EC" d="M135 2Q114 2 90 2T60 1Q35 1 35 11Q35 28 42 40Q45 46 55 46Q119 46 151 94Q153 97 325 402T498 709Q505 716 526 716Q543 716 549 710Q550 709 560 548T580 224T591 57Q594 52 595 52Q603 47 638 46H663Q670 39 670 35Q669 12 657 0H644Q613 2 530 2Q497 2 469 2T424 2T405 1Q388 1 388 10Q388 15 391 24Q392 27 393 32T395 38T397 41T401 44T406 45T415 46Q473 46 487 64L472 306Q468 365 465 426T459 518L457 550Q456 550 328 322T198 88Q196 80 196 77Q196 49 243 46Q261 46 261 35Q261 34 259 22Q256 7 254 4T240 0Q237 0 211 1T135 2Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(727,363) scale(0.707)"><path data-c="2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z" style="stroke-width:3;"></path></g></g><g data-mml-node="msup" transform="translate(971.5,0)"><g data-mml-node="mi"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(808,363) scale(0.707)"><path data-c="2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mi" transform="translate(2023.9,0)"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(3071.9,0)"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(3794.9,0)"><path data-c="1D6EC" d="M135 2Q114 2 90 2T60 1Q35 1 35 11Q35 28 42 40Q45 46 55 46Q119 46 151 94Q153 97 325 402T498 709Q505 716 526 716Q543 716 549 710Q550 709 560 548T580 224T591 57Q594 52 595 52Q603 47 638 46H663Q670 39 670 35Q669 12 657 0H644Q613 2 530 2Q497 2 469 2T424 2T405 1Q388 1 388 10Q388 15 391 24Q392 27 393 32T395 38T397 41T401 44T406 45T415 46Q473 46 487 64L472 306Q468 365 465 426T459 518L457 550Q456 550 328 322T198 88Q196 80 196 77Q196 49 243 46Q261 46 261 35Q261 34 259 22Q256 7 254 4T240 0Q237 0 211 1T135 2Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(4711.1,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(5711.4,0)"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Λ</mi><mo data-mjx-alternate="1">′</mo></msup><msup><mi>Z</mi><mo data-mjx-alternate="1">′</mo></msup><mi>W</mi><mi>Z</mi><mi>Λ</mi><mo>+</mo><mi>I</mi></math></mjx-assistive-mml></mjx-container>, plus the sum of the squared deviance residuals.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/generalizedlinearmixedmodel.jl#L75-L84" target="_blank" rel="noreferrer">source</a><!--]--></span></details><p>Because it is not clear what the saturated model corresponding to a particular <code>LinearMixedModel</code> should be, negative twice the log-likelihood is called the <code>objective</code>.</p><details class="jldocstring custom-block" open><summary><a id="MixedModels.objective" href="#MixedModels.objective"><span class="jlbinding">MixedModels.objective</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinearMixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return negative twice the log-likelihood of model <code>m</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/linearmixedmodel.jl#L784-L788" target="_blank" rel="noreferrer">source</a><!--]--></span></details><p>This value is also accessible as the <code>deviance</code> but the user should bear in mind that this doesn&#39;t have all the properties of a deviance which is corrected for the saturated model. For example, it is not necessarily non-negative.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>327.327059881143</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">deviance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>327.327059881143</span></span></code></pre></div><p>The value optimized when fitting a <code>GeneralizedLinearMixedModel</code> is the Laplace approximation to the deviance or an adaptive Gauss-Hermite evaluation.</p><details class="jldocstring custom-block" open><summary><a id="MixedModels.deviance!" href="#MixedModels.deviance!"><span class="jlbinding">MixedModels.deviance!</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">deviance!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GeneralizedLinearMixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, nAGQ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Update <code>m.η</code>, <code>m.μ</code>, etc., install the working response and working weights in <code>m.LMM</code>, update <code>m.LMM.A</code> and <code>m.LMM.R</code>, then evaluate the <code>deviance</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/generalizedlinearmixedmodel.jl#L135-L140" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">deviance!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>8135.832858348763</span></span></code></pre></div><h2 id="Fixed-effects-parameter-estimates" tabindex="-1">Fixed-effects parameter estimates <a class="header-anchor" href="#Fixed-effects-parameter-estimates" aria-label="Permalink to &quot;Fixed-effects parameter estimates {#Fixed-effects-parameter-estimates}&quot;">​</a></h2><p>The <code>coef</code> and <code>fixef</code> extractors both return the maximum likelihood estimates of the fixed-effects coefficients. They differ in their behavior in the rank-deficient case. The associated <code>coefnames</code> and <code>fixefnames</code> return the corresponding coefficient names.</p><details class="jldocstring custom-block" open><summary><a id="StatsAPI.coef" href="#StatsAPI.coef"><span class="jlbinding">StatsAPI.coef</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">coef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the coefficients of the model.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/statisticalmodel.jl#L8-L12" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="StatsAPI.coefnames" href="#StatsAPI.coefnames"><span class="jlbinding">StatsAPI.coefnames</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">coefnames</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the names of the coefficients.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/statisticalmodel.jl#L15-L19" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="MixedModels.fixef" href="#MixedModels.fixef"><span class="jlbinding">MixedModels.fixef</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fixef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the fixed-effects parameter vector estimate of <code>m</code>.</p><p>In the rank-deficient case the truncated parameter vector, of length <code>rank(m)</code> is returned. This is unlike <code>coef</code> which always returns a vector whose length matches the number of columns in <code>X</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/linearmixedmodel.jl#L551-L559" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="MixedModels.fixefnames" href="#MixedModels.fixefnames"><span class="jlbinding">MixedModels.fixefnames</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fixefnames</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a (permuted and truncated in the rank-deficient case) vector of coefficient names.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/linearmixedmodel.jl#L562-L566" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">coef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">coefnames</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1-element Vector{String}:</span></span>
<span class="line"><span> &quot;(Intercept)&quot;</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fixef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fixefnames</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1-element Vector{String}:</span></span>
<span class="line"><span> &quot;(Intercept)&quot;</span></span></code></pre></div><p>An alternative extractor for the fixed-effects coefficient is the <code>β</code> property. Properties whose names are Greek letters usually have an alternative spelling, which is the name of the Greek letter.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">β</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1-element Vector{Float64}:</span></span>
<span class="line"><span> 1527.4999999999989</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">beta</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1-element Vector{Float64}:</span></span>
<span class="line"><span> 1527.4999999999989</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gm1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">β</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>7-element Vector{Float64}:</span></span>
<span class="line"><span> -0.15297658506693748</span></span>
<span class="line"><span>  0.05739606276708647</span></span>
<span class="line"><span>  0.3207830298410298</span></span>
<span class="line"><span> -1.059879787138412</span></span>
<span class="line"><span> -2.103893961040908</span></span>
<span class="line"><span> -1.054376691878555</span></span>
<span class="line"><span>  0.706980989641357</span></span></code></pre></div><p>A full list of property names is returned by <code>propertynames</code></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">propertynames</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>(:formula, :reterms, :Xymat, :feterm, :sqrtwts, :parmap, :dims, :A, :L, :optsum, :θ, :theta, :β, :beta, :βs, :betas, :λ, :lambda, :stderror, :σ, :sigma, :σs, :sigmas, :σρs, :sigmarhos, :b, :u, :lowerbd, :X, :y, :corr, :vcov, :PCA, :rePCA, :objective, :pvalues)</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">propertynames</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>(:A, :L, :theta, :beta, :coef, :λ, :σ, :sigma, :X, :y, :lowerbd, :objective, :σρs, :σs, :corr, :vcov, :PCA, :rePCA, :LMM, :β, :θ, :b, :u, :resp, :wt)</span></span></code></pre></div><p>The variance-covariance matrix of the fixed-effects coefficients is returned by</p><details class="jldocstring custom-block" open><summary><a id="StatsAPI.vcov" href="#StatsAPI.vcov"><span class="jlbinding">StatsAPI.vcov</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">vcov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the variance-covariance matrix for the coefficients of the model.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/statisticalmodel.jl#L151-L155" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">vcov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm2)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2×2 Matrix{Float64}:</span></span>
<span class="line"><span> 43.9868   -1.37039</span></span>
<span class="line"><span> -1.37039   2.25671</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">vcov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>7×7 Matrix{Float64}:</span></span>
<span class="line"><span>  0.148396    -0.00561488   -0.00982342   …  -0.0112072    -0.011347</span></span>
<span class="line"><span> -0.00561488   0.000280656   7.19122e-5      -1.47964e-5    1.0241e-5</span></span>
<span class="line"><span> -0.00982342   7.19122e-5    0.0365602       -8.04427e-5    5.25878e-5</span></span>
<span class="line"><span> -0.0167988   -1.43709e-5   -9.25629e-5       0.000265802  -0.000172097</span></span>
<span class="line"><span> -0.0166229   -2.90553e-5   -0.000162391      0.000658966  -0.000520523</span></span>
<span class="line"><span> -0.0112072   -1.47964e-5   -8.04427e-5   …   0.0228597    -0.000247782</span></span>
<span class="line"><span> -0.011347     1.0241e-5     5.25878e-5      -0.000247782   0.0228032</span></span></code></pre></div><p>The standard errors are the square roots of the diagonal elements of the estimated variance-covariance matrix of the fixed-effects coefficient estimators.</p><details class="jldocstring custom-block" open><summary><a id="StatsAPI.stderror" href="#StatsAPI.stderror"><span class="jlbinding">StatsAPI.stderror</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">stderror</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the standard errors for the coefficients of the model.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/statisticalmodel.jl#L144-L148" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">stderror</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm2)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2-element Vector{Float64}:</span></span>
<span class="line"><span> 6.632257724308144</span></span>
<span class="line"><span> 1.5022355036397133</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">stderror</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>7-element Vector{Float64}:</span></span>
<span class="line"><span> 0.38522187715517414</span></span>
<span class="line"><span> 0.016752777502287746</span></span>
<span class="line"><span> 0.19120720019964096</span></span>
<span class="line"><span> 0.1841585773287559</span></span>
<span class="line"><span> 0.18651728135544754</span></span>
<span class="line"><span> 0.15119425239025674</span></span>
<span class="line"><span> 0.15100718227007012</span></span></code></pre></div><p>Finally, the <code>coeftable</code> generic produces a table of coefficient estimates, their standard errors, and their ratio. The <em>p-values</em> quoted here should be regarded as approximations.</p><details class="jldocstring custom-block" open><summary><a id="StatsAPI.coeftable" href="#StatsAPI.coeftable"><span class="jlbinding">StatsAPI.coeftable</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">coeftable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatisticalModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Real</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.95</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a table with coefficients and related statistics of the model. <code>level</code> determines the level for confidence intervals (by default, 95%).</p><p>The returned <code>CoefTable</code> object implements the <a href="https://github.com/JuliaData/Tables.jl/" target="_blank" rel="noreferrer">Tables.jl</a> interface, and can be converted e.g. to a <code>DataFrame</code> via <code>using DataFrames; DataFrame(coeftable(model))</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/statisticalmodel.jl#L22-L31" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">coeftable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm2)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>──────────────────────────────────────────────────</span></span>
<span class="line"><span>                Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  251.405      6.63226  37.91    &lt;1e-99</span></span>
<span class="line"><span>days          10.4673     1.50224   6.97    &lt;1e-11</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span></code></pre></div><h2 id="Covariance-parameter-estimates" tabindex="-1">Covariance parameter estimates <a class="header-anchor" href="#Covariance-parameter-estimates" aria-label="Permalink to &quot;Covariance parameter estimates {#Covariance-parameter-estimates}&quot;">​</a></h2><p>The covariance parameters estimates, in the form shown in the model summary, are a <code>VarCorr</code> object</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VarCorr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm2)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.   Corr.</span></span>
<span class="line"><span>subj     (Intercept)  565.51066 23.78047</span></span>
<span class="line"><span>         days          32.68212  5.71683 +0.08</span></span>
<span class="line"><span>Residual              654.94145 25.59182</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VarCorr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Variance components:</span></span>
<span class="line"><span>        Column   Variance Std.Dev. </span></span>
<span class="line"><span>subj (Intercept)  1.793488 1.339212</span></span>
<span class="line"><span>item (Intercept)  0.117149 0.342271</span></span></code></pre></div><p>Individual components are returned by other extractors</p><details class="jldocstring custom-block" open><summary><a id="MixedModels.varest" href="#MixedModels.varest"><span class="jlbinding">MixedModels.varest</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">varest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinearMixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Returns the estimate of σ², the variance of the conditional distribution of Y given B.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/linearmixedmodel.jl#L1287-L1291" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">varest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GeneralizedLinearMixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Returns the estimate of ϕ², the variance of the conditional distribution of Y given B.</p><p>For models with a dispersion parameter ϕ, this is simply ϕ². For models without a dispersion parameter, this value is <code>missing</code>. This differs from <code>disperion</code>, which returns <code>1</code> for models without a dispersion parameter.</p><p>For Gaussian models, this parameter is often called σ².</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/generalizedlinearmixedmodel.jl#L814-L824" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="MixedModels.sdest" href="#MixedModels.sdest"><span class="jlbinding">MixedModels.sdest</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sdest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinearMixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the estimate of σ, the standard deviation of the per-observation noise.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/linearmixedmodel.jl#L987-L991" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sdest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GeneralizedLinearMixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the estimate of the dispersion, i.e. the standard deviation of the per-observation noise.</p><p>For models with a dispersion parameter ϕ, this is simply ϕ. For models without a dispersion parameter, this value is <code>missing</code>. This differs from <code>disperion</code>, which returns <code>1</code> for models without a dispersion parameter.</p><p>For Gaussian models, this parameter is often called σ.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/generalizedlinearmixedmodel.jl#L710-L720" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">varest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm2)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>654.9414500374786</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sdest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm2)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>25.591823890404502</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">σ</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>25.591823890404502</span></span></code></pre></div><h2 id="Conditional-modes-of-the-random-effects" tabindex="-1">Conditional modes of the random effects <a class="header-anchor" href="#Conditional-modes-of-the-random-effects" aria-label="Permalink to &quot;Conditional modes of the random effects {#Conditional-modes-of-the-random-effects}&quot;">​</a></h2><p>The <code>ranef</code> extractor</p><details class="jldocstring custom-block" open><summary><a id="MixedModels.ranef" href="#MixedModels.ranef"><span class="jlbinding">MixedModels.ranef</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ranef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinearMixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; uscale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return, as a <code>Vector{Matrix{T}}</code>, the conditional modes of the random effects in model <code>m</code>.</p><p>If <code>uscale</code> is <code>true</code> the random effects are on the spherical (i.e. <code>u</code>) scale, otherwise on the original scale.</p><p>For a named variant, see <a href="/MixedModels.jl/constructors#MixedModels.raneftables"><code>raneftables</code></a>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/linearmixedmodel.jl#L895-L904" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ranef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1-element Vector{Matrix{Float64}}:</span></span>
<span class="line"><span> [-16.628221011733647 0.36951602248392174 … 53.57982326003439 -42.49434258554296]</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1-element Vector{Matrix{Float64}}:</span></span>
<span class="line"><span> [-16.628221011733647 0.36951602248392174 … 53.57982326003439 -42.49434258554296]</span></span></code></pre></div><p>returns the <em>conditional modes</em> of the random effects given the observed data. That is, these are the values that maximize the conditional density of the random effects given the observed data. For a <code>LinearMixedModel</code> these are also the conditional means.</p><p>These are sometimes called the <em>best linear unbiased predictors</em> or <a href="https://en.wikipedia.org/wiki/Best_linear_unbiased_prediction" target="_blank" rel="noreferrer"><code>BLUPs</code></a> but that name is not particularly meaningful.</p><p>At a superficial level these can be considered as the &quot;estimates&quot; of the random effects, with a bit of hand waving, but pursuing this analogy too far usually results in confusion.</p><p>To obtain tables associating the values of the conditional modes with the levels of the grouping factor, use</p><details class="jldocstring custom-block" open><summary><a id="MixedModels.raneftables" href="#MixedModels.raneftables"><span class="jlbinding">MixedModels.raneftables</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">raneftables</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; uscale </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the conditional means of the random effects as a <code>NamedTuple</code> of Tables.jl-compliant tables.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>The API guarantee is only that the NamedTuple contains Tables.jl tables and not on the particular concrete type of each table.</p></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/mixedmodel.jl#L166-L173" target="_blank" rel="noreferrer">source</a><!--]--></span></details><p>as in</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">only</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">raneftables</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)))</span></span></code></pre></div><div><div><div style = "float: left;"><span>6×2 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">batch</th><th style = "text-align: left;">(Intercept)</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">A</td><td style = "text-align: right;">-16.6282</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">B</td><td style = "text-align: right;">0.369516</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">C</td><td style = "text-align: right;">26.9747</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">D</td><td style = "text-align: right;">-21.8014</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">E</td><td style = "text-align: right;">53.5798</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">F</td><td style = "text-align: right;">-42.4943</td></tr></tbody></table></div></div><p>The corresponding conditional variances are returned by</p><details class="jldocstring custom-block" open><summary><a id="MixedModels.condVar" href="#MixedModels.condVar"><span class="jlbinding">MixedModels.condVar</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">condVar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinearMixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the conditional variances matrices of the random effects.</p><p>The random effects are returned by <code>ranef</code> as a vector of length <code>k</code>, where <code>k</code> is the number of random effects terms. The <code>i</code>th element is a matrix of size <code>vᵢ × ℓᵢ</code> where <code>vᵢ</code> is the size of the vector-valued random effects for each of the <code>ℓᵢ</code> levels of the grouping factor. Technically those values are the modes of the conditional distribution of the random effects given the observed data.</p><p>This function returns an array of <code>k</code> three dimensional arrays, where the <code>i</code>th array is of size <code>vᵢ × vᵢ × ℓᵢ</code>. These are the diagonal blocks from the conditional variance-covariance matrix,</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>s² Λ(Λ&#39;Z&#39;ZΛ + I)⁻¹Λ&#39;</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/MixedModels.jl/blob/v4.31.0/src/linearmixedmodel.jl#L295-L312" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">condVar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1-element Vector{Array{Float64, 3}}:</span></span>
<span class="line"><span> [362.3104675622471;;; 362.3104675622471;;; 362.3104675622471;;; 362.3104675622471;;; 362.3104675622471;;; 362.3104675622471]</span></span></code></pre></div><h2 id="Case-wise-diagnostics-and-residual-degrees-of-freedom" tabindex="-1">Case-wise diagnostics and residual degrees of freedom <a class="header-anchor" href="#Case-wise-diagnostics-and-residual-degrees-of-freedom" aria-label="Permalink to &quot;Case-wise diagnostics and residual degrees of freedom {#Case-wise-diagnostics-and-residual-degrees-of-freedom}&quot;">​</a></h2><p>The <code>leverage</code> values</p><details class="jldocstring custom-block" open><summary><a id="StatsAPI.leverage" href="#StatsAPI.leverage"><span class="jlbinding">StatsAPI.leverage</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">leverage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RegressionModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the diagonal of the projection matrix of the model.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaStats/StatsAPI.jl/blob/v1.7.0/src/regressionmodel.jl#L51-L55" target="_blank" rel="noreferrer">source</a><!--]--></span></details><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">leverage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>30-element Vector{Float64}:</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> ⋮</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span>
<span class="line"><span> 0.15650534082766315</span></span></code></pre></div><p>are used in diagnostics for linear regression models to determine cases that exert a strong influence on their own predicted response.</p><p>The documentation refers to a &quot;projection&quot;. For a linear model without random effects the fitted values are obtained by orthogonal projection of the response onto the column span of the model matrix and the sum of the leverage values is the dimension of this column span. That is, the sum of the leverage values is the rank of the model matrix and <code>n - sum(leverage(m))</code> is the degrees of freedom for residuals. The sum of the leverage values is also the trace of the so-called &quot;hat&quot; matrix, <code>H</code>. (The name &quot;hat matrix&quot; reflects the fact that <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.452ex;" xmlns="http://www.w3.org/2000/svg" width="7.8ex" height="2.29ex" role="img" focusable="false" viewBox="0 -812 3447.6 1012" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D432" d="M84 -102Q84 -110 87 -119T102 -138T133 -149Q148 -148 162 -143T186 -131T206 -114T222 -95T234 -76T243 -59T249 -45T252 -37L269 0L96 382H26V444H34Q49 441 146 441Q252 441 270 444H279V382H255Q232 382 232 380L337 151L442 382H394V444H401Q413 441 495 441Q568 441 574 444H580V382H510L406 152Q298 -84 297 -87Q269 -139 225 -169T131 -200Q85 -200 54 -172T23 -100Q23 -64 44 -50T87 -35Q111 -35 130 -50T152 -92V-100H84V-102Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mo" transform="translate(303.5,18) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mo" transform="translate(884.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1940.6,0)"><g data-mml-node="mi"><path data-c="1D407" d="M400 0Q376 3 226 3Q75 3 51 0H39V62H147V624H39V686H51Q75 683 226 683Q376 683 400 686H412V624H304V388H595V624H487V686H499Q523 683 673 683Q824 683 848 686H860V624H752V62H860V0H848Q824 3 674 3Q523 3 499 0H487V62H595V326H304V62H412V0H400Z" style="stroke-width:3;"></path></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2840.6,0)"><g data-mml-node="mi"><path data-c="1D432" d="M84 -102Q84 -110 87 -119T102 -138T133 -149Q148 -148 162 -143T186 -131T206 -114T222 -95T234 -76T243 -59T249 -45T252 -37L269 0L96 382H26V444H34Q49 441 146 441Q252 441 270 444H279V382H255Q232 382 232 380L337 151L442 382H394V444H401Q413 441 495 441Q568 441 574 444H580V382H510L406 152Q298 -84 297 -87Q269 -139 225 -169T131 -200Q85 -200 54 -172T23 -100Q23 -64 44 -50T87 -35Q111 -35 130 -50T152 -92V-100H84V-102Z" style="stroke-width:3;"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mover><mrow data-mjx-texclass="ORD"><mi mathvariant="bold">y</mi></mrow><mo stretchy="false">^</mo></mover></mrow><mo>=</mo><mrow data-mjx-texclass="ORD"><mi mathvariant="bold">H</mi></mrow><mrow data-mjx-texclass="ORD"><mi mathvariant="bold">y</mi></mrow></math></mjx-assistive-mml></mjx-container>. That is, <code>H</code> puts a hat on <code>y</code>.)</p><p>For a linear mixed model the sum of the leverage values will be between <code>p</code>, the rank of the fixed-effects model matrix, and <code>p + q</code> where <code>q</code> is the total number of random effects. This number does not represent a dimension (or &quot;degrees of freedom&quot;) of a linear subspace of all possible fitted values because the projection is not an orthogonal projection. Nevertheless, it is a reasonable measure of the effective degrees of freedom of the model and <code>n - sum(leverage(m))</code> can be considered the effective residual degrees of freedom.</p><p>For model <code>fm1</code> the dimensions are</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n, p, q, k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>(30, 1, 6, 1)</span></span></code></pre></div><p>which implies that the sum of the leverage values should be in the range [1, 7]. The actual value is</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">leverage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm1))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>4.695160224829895</span></span></code></pre></div><p>For model <code>fm2</code> the dimensions are</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n, p, q, k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm2)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>(180, 2, 36, 1)</span></span></code></pre></div><p>providing a range of [2, 38] for the effective degrees of freedom for the model. The observed value is</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">leverage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm2))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>28.611526266274847</span></span></code></pre></div><p>When a model converges to a singular covariance, such as</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(yield </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">batch)), MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:dyestuff2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> yield ~ 1 + (1 | batch)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>   -81.4365   162.8730   168.8730   169.7961   173.0766</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column   Variance Std.Dev.</span></span>
<span class="line"><span>batch    (Intercept)   0.00000 0.00000</span></span>
<span class="line"><span>Residual              13.34610 3.65323</span></span>
<span class="line"><span> Number of obs: 30; levels of grouping factors: 6</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>───────────────────────────────────────────────</span></span>
<span class="line"><span>              Coef.  Std. Error     z  Pr(&gt;|z|)</span></span>
<span class="line"><span>───────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  5.6656    0.666986  8.49    &lt;1e-16</span></span>
<span class="line"><span>───────────────────────────────────────────────</span></span></code></pre></div><p>the effective degrees of freedom is the lower bound.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">leverage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm3))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>0.9999999999999998</span></span></code></pre></div><p>Models for which the estimates of the variances of the random effects are large relative to the residual variance have effective degrees of freedom close to the upper bound.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(diameter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plate)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sample)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:penicillin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> diameter ~ 1 + (1 | plate) + (1 | sample)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -166.0942   332.1883   340.1883   340.4761   352.0676</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column   Variance Std.Dev. </span></span>
<span class="line"><span>plate    (Intercept)  0.714979 0.845565</span></span>
<span class="line"><span>sample   (Intercept)  3.135193 1.770648</span></span>
<span class="line"><span>Residual              0.302426 0.549933</span></span>
<span class="line"><span> Number of obs: 144; levels of grouping factors: 24, 6</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span>
<span class="line"><span>               Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  22.9722    0.744596  30.85    &lt;1e-99</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">leverage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm4))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>27.46531792078765</span></span></code></pre></div><p>Also, a model fit by the REML criterion generally has larger estimates of the variance components and hence a larger effective degrees of freedom.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm4r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(diameter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plate)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sample)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:penicillin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), REML</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by REML</span></span>
<span class="line"><span> diameter ~ 1 + (1 | plate) + (1 | sample)</span></span>
<span class="line"><span> REML criterion at convergence: 330.8605889912561</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column   Variance Std.Dev. </span></span>
<span class="line"><span>plate    (Intercept)  0.716908 0.846704</span></span>
<span class="line"><span>sample   (Intercept)  3.730907 1.931555</span></span>
<span class="line"><span>Residual              0.302416 0.549923</span></span>
<span class="line"><span> Number of obs: 144; levels of grouping factors: 24, 6</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span>
<span class="line"><span>               Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  22.9722    0.808572  28.41    &lt;1e-99</span></span>
<span class="line"><span>─────────────────────────────────────────────────</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">leverage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fm4r))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>27.472361698411703</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/ajinkya-k/MixedModels.jl/edit/main/docs/src/constructors.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/MixedModels.jl/index" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>MixedModels.jl Documentation</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/MixedModels.jl/optimization" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Details of the parameter estimation</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2025.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api.md\":\"B9ATkEdk\",\"benchmarks.md\":\"D-N-Eic3\",\"bootstrap.md\":\"BNBo3iwu\",\"constructors.md\":\"jcwYrVSW\",\"gausshermite.md\":\"BNITh-nc\",\"index.md\":\"CUxDUPH4\",\"mime.md\":\"COQLynKX\",\"optimization.md\":\"D5x73csF\",\"prediction.md\":\"BNGaXp4b\",\"rankdeficiency.md\":\"ZrVHGPXd\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"MixedModels\",\"description\":\"Documentation for MixedModels.jl\",\"base\":\"/MixedModels.jl/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"MixedModels.jl Documentation\",\"link\":\"/index\"},{\"text\":\"Articles\",\"collapsed\":false,\"items\":[{\"text\":\"Model constructors\",\"link\":\"/constructors\"},{\"text\":\"Details of the parameter estimation\",\"link\":\"/optimization\"},{\"text\":\"Normalized Gauss-Hermite Quadrature\",\"link\":\"/GaussHermite\"},{\"text\":\"Prediction and simulation in Mixed-Effects Models\",\"link\":\"/prediction\"},{\"text\":\"Parametric bootstrap for mixed-effects models\",\"link\":\"/bootstrap\"},{\"text\":\"Rank deficiency in mixed-effects models\",\"link\":\"/rankdeficiency\"},{\"text\":\"Alternative display and output formats\",\"link\":\"/mime\"}]},{\"text\":\"API\",\"link\":\"/api\"},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"MixedModels.jl Documentation\",\"link\":\"/index\"},{\"text\":\"Articles\",\"collapsed\":false,\"items\":[{\"text\":\"Model constructors\",\"link\":\"/constructors\"},{\"text\":\"Details of the parameter estimation\",\"link\":\"/optimization\"},{\"text\":\"Normalized Gauss-Hermite Quadrature\",\"link\":\"/GaussHermite\"},{\"text\":\"Prediction and simulation in Mixed-Effects Models\",\"link\":\"/prediction\"},{\"text\":\"Parametric bootstrap for mixed-effects models\",\"link\":\"/bootstrap\"},{\"text\":\"Rank deficiency in mixed-effects models\",\"link\":\"/rankdeficiency\"},{\"text\":\"Alternative display and output formats\",\"link\":\"/mime\"}]},{\"text\":\"API\",\"link\":\"/api\"}],\"editLink\":{\"pattern\":\"https://https://github.com/ajinkya-k/MixedModels.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/ajinkya-k/MixedModels.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2025.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>
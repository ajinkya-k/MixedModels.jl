import{_ as a,c as i,o as n,aA as p}from"./chunks/framework.BeL8ovVr.js";const c=JSON.parse('{"title":"Prediction and simulation in Mixed-Effects Models","description":"","frontmatter":{},"headers":[],"relativePath":"prediction.md","filePath":"prediction.md","lastUpdated":null}'),e={name:"prediction.md"};function l(t,s,h,k,d,r){return n(),i("div",null,s[0]||(s[0]=[p(`<h1 id="Prediction-and-simulation-in-Mixed-Effects-Models" tabindex="-1">Prediction and simulation in Mixed-Effects Models <a class="header-anchor" href="#Prediction-and-simulation-in-Mixed-Effects-Models" aria-label="Permalink to &quot;Prediction and simulation in Mixed-Effects Models {#Prediction-and-simulation-in-Mixed-Effects-Models}&quot;">​</a></h1><p>We recommend the <a href="https://github.com/RePsychLing/MixedModelsSim.jl/" target="_blank" rel="noreferrer">MixedModelsSim.jl</a> package and associated documentation for useful tools in constructing designs to simulate. For now, we&#39;ll use the sleep study data as a starting point.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataFrames</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MixedModels</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StatsBase</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># use a DataFrame to make it easier to change things later</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">slp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DataFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:sleepstudy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">slpm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), slp)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + (1 | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -897.0393  1794.0786  1802.0786  1802.3072  1814.8505</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.</span></span>
<span class="line"><span>subj     (Intercept)  1296.8692 36.0121</span></span>
<span class="line"><span>Residual               954.5279 30.8954</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span>
<span class="line"><span>                Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  251.405     9.50618   26.45    &lt;1e-99</span></span>
<span class="line"><span>days          10.4673    0.801735  13.06    &lt;1e-38</span></span>
<span class="line"><span>──────────────────────────────────────────────────</span></span></code></pre></div><h2 id="prediction" tabindex="-1">Prediction <a class="header-anchor" href="#prediction" aria-label="Permalink to &quot;Prediction&quot;">​</a></h2><p>The simplest form of prediction are the fitted values from the model: they are indeed the model&#39;s predictions for the observed data.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">predict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≈</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fitted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>true</span></span></code></pre></div><p>When generalizing to new data, we need to consider what happens if there are new, previously unobserved levels of the grouping variable(s). MixedModels.jl provides three options:</p><ol><li><p><code>:error</code>: error on encountering unobserved levels</p></li><li><p><code>:population</code>: use population values (i.e. only the fixed effects) for observations with unobserved levels</p></li><li><p><code>:missing</code>: return <code>missing</code> for observations with unobserved levels.</p></li></ol><p>Providing either no prediction (<code>:error</code>, <code>:missing</code>) or providing the population-level values seem to be the most reasonable ways for <em>predicting</em> new values. For <em>simulating</em> new values based on previous estimates of the variance components, use <code>simulate</code>.</p><p>In the case where there are no new levels of the grouping variable, all three of these methods provide the same results:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">predict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm, slp; new_re_levels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:population</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≈</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fitted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>true</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">predict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm, slp; new_re_levels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:missing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≈</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fitted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>true</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">predict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm, slp; new_re_levels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≈</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fitted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>true</span></span></code></pre></div><p>In the case where there are new levels of the grouping variable, these methods differ.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># create a new level</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">slp2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> transform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slp, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:subj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ByRow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;S308&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;NEW&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :subj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>180×3 DataFrame</span></span>
<span class="line"><span> Row │ subj    days  reaction</span></span>
<span class="line"><span>     │ String  Int8  Float64</span></span>
<span class="line"><span>─────┼────────────────────────</span></span>
<span class="line"><span>   1 │ NEW        0   249.56</span></span>
<span class="line"><span>   2 │ NEW        1   258.705</span></span>
<span class="line"><span>   3 │ NEW        2   250.801</span></span>
<span class="line"><span>   4 │ NEW        3   321.44</span></span>
<span class="line"><span>   5 │ NEW        4   356.852</span></span>
<span class="line"><span>   6 │ NEW        5   414.69</span></span>
<span class="line"><span>   7 │ NEW        6   382.204</span></span>
<span class="line"><span>   8 │ NEW        7   290.149</span></span>
<span class="line"><span>  ⋮  │   ⋮      ⋮       ⋮</span></span>
<span class="line"><span> 174 │ S372       3   310.632</span></span>
<span class="line"><span> 175 │ S372       4   287.173</span></span>
<span class="line"><span> 176 │ S372       5   329.608</span></span>
<span class="line"><span> 177 │ S372       6   334.482</span></span>
<span class="line"><span> 178 │ S372       7   343.22</span></span>
<span class="line"><span> 179 │ S372       8   369.142</span></span>
<span class="line"><span> 180 │ S372       9   364.124</span></span>
<span class="line"><span>              165 rows omitted</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">try</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  predict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm, slp2; new_re_levels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ArgumentError(&quot;New level encountered in subj&quot;)</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">predict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm, slp2; new_re_levels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:missing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>180-element Vector{Union{Missing, Float64}}:</span></span>
<span class="line"><span>    missing</span></span>
<span class="line"><span>    missing</span></span>
<span class="line"><span>    missing</span></span>
<span class="line"><span>    missing</span></span>
<span class="line"><span>    missing</span></span>
<span class="line"><span>    missing</span></span>
<span class="line"><span>    missing</span></span>
<span class="line"><span>    missing</span></span>
<span class="line"><span>    missing</span></span>
<span class="line"><span>    missing</span></span>
<span class="line"><span>   ⋮</span></span>
<span class="line"><span> 279.92212396847816</span></span>
<span class="line"><span> 290.38940992807414</span></span>
<span class="line"><span> 300.8566958876701</span></span>
<span class="line"><span> 311.32398184726617</span></span>
<span class="line"><span> 321.79126780686215</span></span>
<span class="line"><span> 332.25855376645814</span></span>
<span class="line"><span> 342.7258397260541</span></span>
<span class="line"><span> 353.1931256856501</span></span>
<span class="line"><span> 363.66041164524614</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">predict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm, slp2; new_re_levels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:population</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>180-element Vector{Float64}:</span></span>
<span class="line"><span> 251.40510484848508</span></span>
<span class="line"><span> 261.8723908080811</span></span>
<span class="line"><span> 272.3396767676771</span></span>
<span class="line"><span> 282.80696272727306</span></span>
<span class="line"><span> 293.2742486868691</span></span>
<span class="line"><span> 303.7415346464651</span></span>
<span class="line"><span> 314.20882060606107</span></span>
<span class="line"><span> 324.67610656565705</span></span>
<span class="line"><span> 335.14339252525303</span></span>
<span class="line"><span> 345.6106784848491</span></span>
<span class="line"><span>   ⋮</span></span>
<span class="line"><span> 279.92212396847816</span></span>
<span class="line"><span> 290.38940992807414</span></span>
<span class="line"><span> 300.8566958876701</span></span>
<span class="line"><span> 311.32398184726617</span></span>
<span class="line"><span> 321.79126780686215</span></span>
<span class="line"><span> 332.25855376645814</span></span>
<span class="line"><span> 342.7258397260541</span></span>
<span class="line"><span> 353.1931256856501</span></span>
<span class="line"><span> 363.66041164524614</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Currently, we do not support predicting based on a subset of the random effects.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p><code>predict</code> is deterministic (within the constraints of floating point) and never adds noise to the result. If you want to construct prediction intervals, then <code>simulate</code> will generate new data with noise (including new values of the random effects).</p></div><p>For generalized linear mixed models, there is an additional keyword argument to <code>predict</code>: <code>type</code> specifies whether the predictions are returned on the scale of the linear predictor (<code>:linpred</code>) or on the level of the response <code>(:response)</code> (i.e. the level at which the values were originally observed).</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cbpp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DataFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:cbpp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cbpp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cbpp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">incid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cbpp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hsz</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MixedModel, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> period </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">herd)), cbpp, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Binomial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), wts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cbpp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hsz))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">predict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm, cbpp; type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≈</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fitted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>false</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">logit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">predict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm, cbpp; type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:linpred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≈</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> logit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fitted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gm))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>false</span></span></code></pre></div><h2 id="simulation" tabindex="-1">Simulation <a class="header-anchor" href="#simulation" aria-label="Permalink to &quot;Simulation&quot;">​</a></h2><p>In contrast to <code>predict</code>, <code>simulate</code> and <code>simulate!</code> introduce randomness. This randomness occurs both at the level of the observation-level (residual) variance and at the level of the random effects, where new conditional modes are sampled based on the specified covariance parameter (θ; see <a href="/MixedModels.jl/optimization#Details-of-the-parameter-estimation">Details of the parameter estimation</a>), which defaults to the estimated value of the model. For reproducibility, we specify a pseudorandom generator here; if none is provided, the global PRNG is taken as the default.</p><p>The simplest example of <code>simulate</code> takes a fitted model and generates a new response vector based on the existing model matrices combined with noise.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Random</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ynew </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MersenneTwister</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), slpm)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>180-element Vector{Float64}:</span></span>
<span class="line"><span> 252.6752171388051</span></span>
<span class="line"><span> 223.3096173669927</span></span>
<span class="line"><span> 248.6842723713382</span></span>
<span class="line"><span> 255.64305141427212</span></span>
<span class="line"><span> 255.08087250538287</span></span>
<span class="line"><span> 286.58862952243004</span></span>
<span class="line"><span> 309.5056915487952</span></span>
<span class="line"><span> 286.88987784213936</span></span>
<span class="line"><span> 281.3989535401713</span></span>
<span class="line"><span> 282.98845110151944</span></span>
<span class="line"><span>   ⋮</span></span>
<span class="line"><span> 250.81655745160242</span></span>
<span class="line"><span> 271.2543649019418</span></span>
<span class="line"><span> 248.48273283810676</span></span>
<span class="line"><span> 305.9014182133385</span></span>
<span class="line"><span> 260.66238230893254</span></span>
<span class="line"><span> 298.11865200662567</span></span>
<span class="line"><span> 360.1816309547196</span></span>
<span class="line"><span> 353.9285987403432</span></span>
<span class="line"><span> 382.89445970316854</span></span></code></pre></div><p>The simulated response can also be placed in a pre-allocated vector:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ynew2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nrow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slp))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">simulate!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MersenneTwister</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), ynew2, slpm)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ynew2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≈</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ynew</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>true</span></span></code></pre></div><p>Or even directly replace the previous response vector in a model, at which point the model must be refit to the new values:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">slpm2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> deepcopy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(slpm)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">refit!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">simulate!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MersenneTwister</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), slpm2))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + (1 | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -895.6915  1791.3830  1799.3830  1799.6116  1812.1549</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column   Variance Std.Dev.</span></span>
<span class="line"><span>subj     (Intercept)  912.8712 30.2138</span></span>
<span class="line"><span>Residual              972.8494 31.1905</span></span>
<span class="line"><span> Number of obs: 180; levels of grouping factors: 18</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>                 Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  248.336      8.32982   29.81    &lt;1e-99</span></span>
<span class="line"><span>days           8.00599    0.809393   9.89    &lt;1e-22</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span></code></pre></div><p>This inplace simulation actually forms the basis of <a href="/MixedModels.jl/bootstrap#MixedModels.parametricbootstrap"><code>parametricbootstrap</code></a>.</p><p>Finally, we can also simulate the response from entirely new data.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DataFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> repeat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, outer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), subj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">repeat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:subj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;S&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lpad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(df</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:reaction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>200×3 DataFrame</span></span>
<span class="line"><span> Row │ days   subj    reaction</span></span>
<span class="line"><span>     │ Int64  String  Int64</span></span>
<span class="line"><span>─────┼─────────────────────────</span></span>
<span class="line"><span>   1 │     1  S01            0</span></span>
<span class="line"><span>   2 │     2  S01            0</span></span>
<span class="line"><span>   3 │     3  S01            0</span></span>
<span class="line"><span>   4 │     4  S01            0</span></span>
<span class="line"><span>   5 │     5  S01            0</span></span>
<span class="line"><span>   6 │     6  S01            0</span></span>
<span class="line"><span>   7 │     7  S01            0</span></span>
<span class="line"><span>   8 │     8  S01            0</span></span>
<span class="line"><span>  ⋮  │   ⋮      ⋮        ⋮</span></span>
<span class="line"><span> 194 │     4  S20            0</span></span>
<span class="line"><span> 195 │     5  S20            0</span></span>
<span class="line"><span> 196 │     6  S20            0</span></span>
<span class="line"><span> 197 │     7  S20            0</span></span>
<span class="line"><span> 198 │     8  S20            0</span></span>
<span class="line"><span> 199 │     9  S20            0</span></span>
<span class="line"><span> 200 │    10  S20            0</span></span>
<span class="line"><span>               185 rows omitted</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ysim </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MersenneTwister</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), slpm, df)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>200-element Vector{Float64}:</span></span>
<span class="line"><span> 255.00432150851708</span></span>
<span class="line"><span> 225.63872173670472</span></span>
<span class="line"><span> 251.0133767410502</span></span>
<span class="line"><span> 257.9721557839841</span></span>
<span class="line"><span> 257.40997687509486</span></span>
<span class="line"><span> 288.91773389214205</span></span>
<span class="line"><span> 311.83479591850715</span></span>
<span class="line"><span> 289.21898221185137</span></span>
<span class="line"><span> 283.72805790988326</span></span>
<span class="line"><span> 285.31755547123146</span></span>
<span class="line"><span>   ⋮</span></span>
<span class="line"><span> 197.4028748844943</span></span>
<span class="line"><span> 138.22165310892973</span></span>
<span class="line"><span> 187.19029860225433</span></span>
<span class="line"><span> 215.87081467989628</span></span>
<span class="line"><span> 220.4557805243008</span></span>
<span class="line"><span> 267.6032837398289</span></span>
<span class="line"><span> 245.3979923049997</span></span>
<span class="line"><span> 304.0437000517243</span></span>
<span class="line"><span> 253.65615200259157</span></span></code></pre></div><p>Note that this is a convenience method for creating a new model and then using the parameters from the old model to call <code>simulate</code> on that model. In other words, this method incurs the cost of constructing a new model and then discarding it. If you could re-use that model (e.g., fitting that model as part of a simulation study), it often makes sense to do these steps to perform these steps explicitly and avoid the unnecessary construction and discarding of an intermediate model:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">msim </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LinearMixedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@formula</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> days </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subj)), df)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">simulate!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MersenneTwister</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), msim; θ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">slpm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">θ, β</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">slpm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">β, σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">slpm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">σ)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(msim) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≈</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ysim</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>true</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fit!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(msim)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Linear mixed model fit by maximum likelihood</span></span>
<span class="line"><span> reaction ~ 1 + days + (1 | subj)</span></span>
<span class="line"><span>   logLik   -2 logLik     AIC       AICc        BIC    </span></span>
<span class="line"><span>  -996.8296  1993.6592  2001.6592  2001.8643  2014.8524</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Variance components:</span></span>
<span class="line"><span>            Column    Variance Std.Dev.</span></span>
<span class="line"><span>subj     (Intercept)  1292.4331 35.9504</span></span>
<span class="line"><span>Residual               956.1199 30.9212</span></span>
<span class="line"><span> Number of obs: 200; levels of grouping factors: 20</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Fixed-effects parameters:</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>                 Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span>
<span class="line"><span>(Intercept)  250.284      9.32369   26.84    &lt;1e-99</span></span>
<span class="line"><span>days           8.08794    0.761227  10.62    &lt;1e-25</span></span>
<span class="line"><span>───────────────────────────────────────────────────</span></span></code></pre></div><p>For simulating from generalized linear mixed models, there is no <code>type</code> option because the observation-level always occurs at the level of the response and not of the linear predictor.</p><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>Simulating the model response in place may not yield the same result as simulating into a pre-allocated or new vector, depending on choice of pseudorandom number generator. Random number generation in Julia allows optimization based on type, and the internal storage type of the model response (currently a view into a matrix storing the concatenated fixed-effects model matrix and the response) may not match the type of a pre-allocated or new vector. See also <a href="https://discourse.julialang.org/t/weird-prng-behavior/63186" target="_blank" rel="noreferrer">discussion here</a>.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>All the methods that take new data as a table construct an additional <code>MixedModel</code> behind the scenes, even when the new data is exactly the same as the data that the model was fitted to. For the simulation methods in particular, these thus form a convenience wrapper for constructing a new model and calling <code>simulate</code> without new data on that model with the parameters from the original model.</p></div>`,59)]))}const g=a(e,[["render",l]]);export{c as __pageData,g as default};
